

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>BPMF.dataset &mdash; BPMF 2.0.0beta2 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=96e89336"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="BPMF.data_reader_examples" href="data_reader_examples.html" />
    <link rel="prev" title="BPMF.clib" href="clib.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            BPMF
              <img src="../../_static/bpmf.svg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../introduction.html">Introduction</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../usage.html">Usage</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../api.html">API</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="clib.html">BPMF.clib</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">BPMF.dataset</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#BPMF.dataset.Catalog"><code class="docutils literal notranslate"><span class="pre">Catalog</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#BPMF.dataset.Data"><code class="docutils literal notranslate"><span class="pre">Data</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#BPMF.dataset.Event"><code class="docutils literal notranslate"><span class="pre">Event</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#BPMF.dataset.EventGroup"><code class="docutils literal notranslate"><span class="pre">EventGroup</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#BPMF.dataset.Family"><code class="docutils literal notranslate"><span class="pre">Family</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#BPMF.dataset.Network"><code class="docutils literal notranslate"><span class="pre">Network</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#BPMF.dataset.Stack"><code class="docutils literal notranslate"><span class="pre">Stack</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#BPMF.dataset.Template"><code class="docutils literal notranslate"><span class="pre">Template</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#BPMF.dataset.TemplateGroup"><code class="docutils literal notranslate"><span class="pre">TemplateGroup</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="data_reader_examples.html">BPMF.data_reader_examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="NLLoc_utils.html">BPMF.NLLoc_utils</a></li>
<li class="toctree-l3"><a class="reference internal" href="plotting_utils.html">BPMF.plotting_utils</a></li>
<li class="toctree-l3"><a class="reference internal" href="similarity_search.html">BPMF.similarity_search</a></li>
<li class="toctree-l3"><a class="reference internal" href="spectrum.html">BPMF.spectrum</a></li>
<li class="toctree-l3"><a class="reference internal" href="template_search.html">BPMF.template_search</a></li>
<li class="toctree-l3"><a class="reference internal" href="utils.html">BPMF.utils</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../updates.html">Updates</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">BPMF</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../usage.html">Usage</a></li>
          <li class="breadcrumb-item"><a href="../api.html">API</a></li>
      <li class="breadcrumb-item active">BPMF.dataset</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/usage/api/dataset.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-BPMF.dataset">
<span id="bpmf-dataset"></span><h1>BPMF.dataset<a class="headerlink" href="#module-BPMF.dataset" title="Link to this heading"></a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="BPMF.dataset.Catalog">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">BPMF.dataset.</span></span><span class="sig-name descname"><span class="pre">Catalog</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">longitudes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latitudes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depths</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">origin_times</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">event_ids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#Catalog"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.Catalog" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class for catalog data, and basic plotting.</p>
<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Catalog.concatenate">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">concatenate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">catalogs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#Catalog.concatenate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.Catalog.concatenate" title="Link to this definition"></a></dt>
<dd><p>Build catalog from list of <cite>pandas.DataFrame</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>catalogs</strong> (list of <cite>pandas.DataFrame</cite>) – List of <cite>pandas.DataFrame</cite> with consistent columns.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.Catalog.depth">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">depth</span></span><a class="headerlink" href="#BPMF.dataset.Catalog.depth" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.Catalog.latitude">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">latitude</span></span><a class="headerlink" href="#BPMF.dataset.Catalog.latitude" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.Catalog.longitude">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">longitude</span></span><a class="headerlink" href="#BPMF.dataset.Catalog.longitude" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.Catalog.n_events">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_events</span></span><a class="headerlink" href="#BPMF.dataset.Catalog.n_events" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.Catalog.origin_time">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">origin_time</span></span><a class="headerlink" href="#BPMF.dataset.Catalog.origin_time" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Catalog.plot_map">
<span class="sig-name descname"><span class="pre">plot_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(20,</span> <span class="pre">10)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">network</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_uncertainties</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth_colorbar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#Catalog.plot_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.Catalog.plot_map" title="Link to this definition"></a></dt>
<dd><p>Plot epicenters on map.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> (<em>matplotlib.pyplot.Axes</em><em>, </em><em>default to None</em>) – If None, create a new <cite>plt.Figure</cite> and <cite>plt.Axes</cite> instances. If
speficied by user, use the provided instance to plot.</p></li>
<li><p><strong>figsize</strong> (<em>tuple</em><em> of </em><em>floats</em><em>, </em><em>default to</em><em> (</em><em>20</em><em>, </em><em>10</em><em>)</em>) – Size, in inches, of the figure (width, height).</p></li>
<li><p><strong>depth_min</strong> (<em>scalar float</em><em>, </em><em>default to 0</em>) – Smallest depth, in km, in the depth colormap.</p></li>
<li><p><strong>depth_max</strong> (<em>scalar float</em><em>, </em><em>default to 20</em>) – Largest depth, in km, in the depth colormap.</p></li>
<li><p><strong>network</strong> (<a class="reference internal" href="#BPMF.dataset.Network" title="BPMF.dataset.Network"><em>BPMF.dataset.Network</em></a><em>, </em><em>optional</em>) – If provided, use information in <cite>network</cite> to plot the stations.</p></li>
<li><p><strong>plot_uncertainties</strong> (<em>boolean</em><em>, </em><em>default to False</em>) – If True, plot the location uncertainty ellipses.</p></li>
<li><p><strong>depth_colorbar</strong> (<em>boolean</em><em>, </em><em>default to True</em>) – If True, plot the depth colorbar on the left.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fig</strong> – The figure with depth color-coded epicenters.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>matplotlib.pyplot.Figure</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Catalog.plot_space_time">
<span class="sig-name descname"><span class="pre">plot_space_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(20,</span> <span class="pre">10)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_coded</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'longitude'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'latitude'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#Catalog.plot_space_time"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.Catalog.plot_space_time" title="Link to this definition"></a></dt>
<dd><p>Plot the space-time event distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> (<cite>plt.Axes</cite>, default to None) – If None, create a new <cite>plt.Figure</cite> and <cite>plt.Axes</cite> instances. If
speficied by user, use the provided instance to plot.</p></li>
<li><p><strong>figsize</strong> (<em>tuple</em><em> of </em><em>floats</em><em>, </em><em>default to</em><em> (</em><em>20</em><em>, </em><em>10</em><em>)</em>) – Size, in inches, of the figure (width, height).</p></li>
<li><p><strong>color_coded</strong> (<em>string</em><em>, </em><em>default to 'longitude'</em>) – Can be either ‘longitude’, ‘latitude’, or ‘depth’. This is the
attribute used to define the color scale of each dot.</p></li>
<li><p><strong>y_axis</strong> (<em>string</em><em>, </em><em>default to 'latitude'</em>) – Can be either ‘longitude’, ‘latitude’, or ‘depth’. This is the
attribute used to define the y-axis coordinates.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fig</strong> – The figure with color coded latitudes or longitudes.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>matplotlib.pyplot.Figure</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Catalog.plot_time_statistics">
<span class="sig-name descname"><span class="pre">plot_time_statistics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">UTC_local_corr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(16,</span> <span class="pre">7)</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#Catalog.plot_time_statistics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.Catalog.plot_time_statistics" title="Link to this definition"></a></dt>
<dd><p>Plot the histograms of time of the day and day of the week.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>figsize</strong> (<em>tuple</em><em> of </em><em>floats</em><em>, </em><em>optional</em>) – Size, in inches, of the figure (width, height). Default is (16, 7).</p></li>
<li><p><strong>UTC_local_corr</strong> (<em>float</em><em>, </em><em>optional</em>) – <dl class="simple">
<dt>Apply UTC to local time correction such that:</dt><dd><p><cite>local_hour = UTC_hour + UTC_local_corr</cite></p>
</dd>
</dl>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fig</strong> – The created matplotlib Figure object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>matplotlib.figure.Figure</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Catalog.read_from_dataframe">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">read_from_dataframe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataframe</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#Catalog.read_from_dataframe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.Catalog.read_from_dataframe" title="Link to this definition"></a></dt>
<dd><p>Initialize a Catalog instance from a <cite>pandas.DataFrame</cite> instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dataframe</strong> (<cite>pandas.DataFrame</cite>) – <cite>pandas.DataFrame</cite> from which the <cite>Catalog</cite> instance will
be built.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>catalog</strong> – <cite>Catalog</cite> instance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>Catalog</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Catalog.read_from_detection_file">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">read_from_detection_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">db_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_attributes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">nan</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_events</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_threads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#Catalog.read_from_detection_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.Catalog.read_from_detection_file" title="Link to this definition"></a></dt>
<dd><p>Read all detected events and build catalog.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>string</em>) – Name of the hdf5 file with the event data base.</p></li>
<li><p><strong>db_path</strong> (<em>string</em><em>, </em><em>optional</em>) – Name of the directory where <cite>filename</cite> is located.
Default is <cite>config.OUTPUT_PATH</cite>.</p></li>
<li><p><strong>gid</strong> (<em>string</em><em> or </em><em>float</em><em> or </em><em>int</em><em>, </em><em>optional</em>) – Name of the group to read within the hdf5 file. If
None (default), reads all the groups in the root
directory of the hdf5 file.</p></li>
<li><p><strong>extra_attributes</strong> (<em>list</em><em>, </em><em>optional</em>) – Default attributes included in the catalog are: longitude,
latitude, depth and origin time. Any extra attribute that
should be returned in the catalog should be given here as
a string in a list.
Example: <cite>extra_attributes=[‘hmax_inc’, ‘vmax_inc’]</cite></p></li>
<li><p><strong>fill_value</strong> (<em>any</em><em>, </em><em>optional</em>) – Value that is returned in the catalog if an attribute
from <cite>extra_attributes</cite> is not found. Default is <cite>numpy.nan</cite>.</p></li>
<li><p><strong>n_threads</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of threads to use for parallel execution. If set to 1
(default), the detection files will be read sequentially. If set to
a value greater than 1, the detection files will be read in
parallel using <cite>n_threads</cite> threads.</p></li>
<li><p><strong>return_events</strong> (<em>boolean</em><em>, </em><em>optional</em>) – If True, returns the list of <cite>Event</cite> instances in addition to
the <cite>Catalog</cite> instance. Default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>catalog</strong> (<cite>Catalog</cite>) – <cite>Catalog</cite> instance.</p></li>
<li><p><strong>events</strong> (<em>list, optional</em>) – List of <cite>Event</cite> instances of <cite>return_events=True</cite>.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Catalog.read_from_events">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">read_from_events</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">events</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_attributes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">nan</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#Catalog.read_from_events"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.Catalog.read_from_events" title="Link to this definition"></a></dt>
<dd><p>Build catalog from list of <cite>Event</cite> instances.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>events</strong> (<em>list</em>) – List of <cite>Event</cite> instances.</p></li>
<li><p><strong>extra_attributes</strong> (<em>list</em><em>, </em><em>optional</em>) – Default attributes included in the catalog are: longitude,
latitude, depth and origin time. Any extra attribute that
should be returned in the catalog should be given here as
a string in a list.
Example: <cite>extra_attributes=[‘hmax_inc’, ‘vmax_inc’]</cite></p></li>
<li><p><strong>fill_value</strong> (<em>any</em><em>, </em><em>optional</em>) – Value that is returned in the catalog if an attribute
from <cite>extra_attributes</cite> is not found. Default is <cite>numpy.nan</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>catalog</strong> – <cite>Catalog</cite> instance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>Catalog</cite></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="BPMF.dataset.Data">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">BPMF.dataset.</span></span><span class="sig-name descname"><span class="pre">Data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">where</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_reader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">duration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">86400.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#Data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.Data" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A Data class to manipulate waveforms and metadata.</p>
<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Data.get_np_array">
<span class="sig-name descname"><span class="pre">get_np_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stations</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">components</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['N',</span> <span class="pre">'E',</span> <span class="pre">'Z']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">component_aliases</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'E':</span> <span class="pre">['E',</span> <span class="pre">'2'],</span> <span class="pre">'N':</span> <span class="pre">['N',</span> <span class="pre">'1'],</span> <span class="pre">'Z':</span> <span class="pre">['Z']}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">priority</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'HH'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#Data.get_np_array"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.Data.get_np_array" title="Link to this definition"></a></dt>
<dd><p>Arguments go to <cite>BPMF.utils.get_np_array</cite>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Data.read_waveforms">
<span class="sig-name descname"><span class="pre">read_waveforms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trim_traces</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">reader_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#Data.read_waveforms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.Data.read_waveforms" title="Link to this definition"></a></dt>
<dd><p>Read the waveform time series.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>trim_traces</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, call <cite>trim_waveforms</cite> to make sure all traces have the same
start time.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Additional parameters can be provided as keyword arguments <cite>**reader_kwargs</cite>
which are passed to the <cite>data_reader</cite> method for waveform reading.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Data.set_availability">
<span class="sig-name descname"><span class="pre">set_availability</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stations</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">components</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['N',</span> <span class="pre">'E',</span> <span class="pre">'Z']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">component_aliases</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'E':</span> <span class="pre">['E',</span> <span class="pre">'2'],</span> <span class="pre">'N':</span> <span class="pre">['N',</span> <span class="pre">'1'],</span> <span class="pre">'Z':</span> <span class="pre">['Z']}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#Data.set_availability"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.Data.set_availability" title="Link to this definition"></a></dt>
<dd><p>Set the data availability.</p>
<p>A station is available if at least one station has non-zero data. The
availability is then accessed via the property <cite>self.availability</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stations</strong> (<em>list</em><em> of </em><em>strings</em><em> or </em><em>numpy.ndarray</em>) – Names of the stations on which we check availability. If None, use
<cite>self.stations</cite>.</p></li>
<li><p><strong>components</strong> (<em>list</em><em>, </em><em>optional</em>) – List of component codes to consider for availability check,
by default [“N”, “E”, “Z”]</p></li>
<li><p><strong>component_aliases</strong> (<em>dict</em><em>, </em><em>optional</em>) – Dictionary mapping component codes to their aliases,
by default {“N”: [“N”, “1”], “E”: [“E”, “2”], “Z”: [“Z”]}</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.Data.sr">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sr</span></span><a class="headerlink" href="#BPMF.dataset.Data.sr" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.Data.time">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">time</span></span><a class="headerlink" href="#BPMF.dataset.Data.time" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Data.trim_waveforms">
<span class="sig-name descname"><span class="pre">trim_waveforms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">starttime</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">endtime</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#Data.trim_waveforms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.Data.trim_waveforms" title="Link to this definition"></a></dt>
<dd><p>Trim waveforms.</p>
<p>Adjusts the start and end times of waveforms to ensure all traces
are synchronized.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>starttime</strong> (<em>str</em><em> or </em><em>datetime</em><em>, </em><em>optional</em>) – Start time to use for trimming the waveforms. If None,
<cite>self.date</cite> is used as the start time. (default None)</p></li>
<li><p><strong>endtime</strong> (<em>str</em><em> or </em><em>datetime</em><em>, </em><em>optional</em>) – End time to use for trimming the waveforms. If None,
<cite>self.date</cite> + <cite>self.duration</cite> is used as the end time. (default None)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="BPMF.dataset.Event">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">BPMF.dataset.</span></span><span class="sig-name descname"><span class="pre">Event</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">origin_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">moveouts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stations</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phases</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latitude</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">longitude</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">component_aliases</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'E':</span> <span class="pre">['E',</span> <span class="pre">'2'],</span> <span class="pre">'N':</span> <span class="pre">['N',</span> <span class="pre">'1'],</span> <span class="pre">'Z':</span> <span class="pre">['Z']}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">components</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['N',</span> <span class="pre">'E',</span> <span class="pre">'Z']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_reader</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#Event"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.Event" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>An Event class to describe <em>any</em> collection of waveforms.</p>
<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.Event.availability">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">availability</span></span><a class="headerlink" href="#BPMF.dataset.Event.availability" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.Event.availability_per_cha">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">availability_per_cha</span></span><a class="headerlink" href="#BPMF.dataset.Event.availability_per_cha" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.Event.availability_per_sta">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">availability_per_sta</span></span><a class="headerlink" href="#BPMF.dataset.Event.availability_per_sta" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.Event.az_hmax_unc">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">az_hmax_unc</span></span><a class="headerlink" href="#BPMF.dataset.Event.az_hmax_unc" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.Event.az_hmin_unc">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">az_hmin_unc</span></span><a class="headerlink" href="#BPMF.dataset.Event.az_hmin_unc" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Event.compute_snr">
<span class="sig-name descname"><span class="pre">compute_snr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">noise_window_sec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">data_reader_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#Event.compute_snr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.Event.compute_snr" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>noise_window_sec</strong> (<em>float</em><em>, </em><em>optional</em>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Event.get_np_array">
<span class="sig-name descname"><span class="pre">get_np_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stations</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">components</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">priority</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'HH'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#Event.get_np_array"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.Event.get_np_array" title="Link to this definition"></a></dt>
<dd><p>Arguments are passed to <cite>BPMF.utils.get_np_array</cite>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Event.get_peak_amplitudes">
<span class="sig-name descname"><span class="pre">get_peak_amplitudes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stations</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">components</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#Event.get_peak_amplitudes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.Event.get_peak_amplitudes" title="Link to this definition"></a></dt>
<dd><p>Get peak waveform amplitudes.</p>
<p>The peak waveform amplitudes are typically used to compute
amplitude-based local magnitudes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stations</strong> (<em>list</em><em> of </em><em>strings</em>) – Names of the stations to include in the output array. Define the order
of the station axis.</p></li>
<li><p><strong>components</strong> (<em>list</em><em> of </em><em>strings</em><em>, </em><em>default to</em><em> [</em><em>'N'</em><em>,</em><em>'E'</em><em>,</em><em>'Z'</em><em>]</em>) – Names of the components to include in the output array. Define the order
of the component axis.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>peak_amplitudes</strong> – (num_stations, num_components) numpy.ndarray with the peak
waveform amplitude on each channel.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.Event.hmax_unc">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">hmax_unc</span></span><a class="headerlink" href="#BPMF.dataset.Event.hmax_unc" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.Event.hmin_unc">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">hmin_unc</span></span><a class="headerlink" href="#BPMF.dataset.Event.hmin_unc" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Event.hor_ver_uncertainties">
<span class="sig-name descname"><span class="pre">hor_ver_uncertainties</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'intersection'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#Event.hor_ver_uncertainties"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.Event.hor_ver_uncertainties" title="Link to this definition"></a></dt>
<dd><p>Compute the horizontal and vertical uncertainties on location.</p>
<p>Returns the errors as given by the 68% confidence ellipsoid.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mode</strong> (<em>str</em><em>, </em><em>optional</em>) – Specifies the mode for calculating the horizontal uncertainties.
- If ‘intersection’, the horizontal uncertainties are the lengths
of the semi-axes of the ellipse defined by the intersection between
the confidence ellipsoid and the horizontal plane.
- If ‘projection’, the horizontal uncertainties are the maximum and minimum
spans of the confidence ellipsoid in the horizontal directions.
(default ‘intersection’)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>None</strong> – </p></li>
<li><p><strong>New Attributes</strong> – </p></li>
<li><p><strong>--------------</strong> – </p></li>
</ul>
</dd>
</dl>
<p>:raises _hmax_unc : float: The maximum horizontal uncertainty in kilometers.
:raises _hmin_unc : float: The minimum horizontal uncertainty in kilometers.
:raises _vmax_unc : float: The maximum vertical uncertainty in kilometers.
:raises _az_hmax_unc : float: The azimuth (angle from north) of the maximum horizontal uncertainty in degrees.
:raises _az_hmin_unc : float: The azimuth (angle from north) of the minimum horizontal uncertainty in degrees.</p>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The sum of _hmax_unc and _vmax_unc does not necessarily equal the</p></li>
</ul>
<p>maximum length of the uncertainty ellipsoid’s semi-axis; the latter
represents the longest semi-axis of the ellipsoid.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.Event.location">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">location</span></span><a class="headerlink" href="#BPMF.dataset.Event.location" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Event.n_best_SNR_stations">
<span class="sig-name descname"><span class="pre">n_best_SNR_stations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">available_stations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#Event.n_best_SNR_stations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.Event.n_best_SNR_stations" title="Link to this definition"></a></dt>
<dd><p>Adjust <cite>self.stations</cite> to the <cite>n</cite> best SNR stations.</p>
<p>This function finds the <cite>n</cite> best stations based on signal-to-noise ratio (SNR)
and modifies the <cite>self.stations</cite> attribute accordingly. The instance’s properties
will also change to reflect the new selection of stations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<em>int</em>) – The number of best SNR stations to select.</p></li>
<li><p><strong>available_stations</strong> (<em>list</em><em> of </em><em>str</em><em>, </em><em>default None</em>) – The list of stations from which to search for the closest stations. If
provided, only stations in this list will be considered. This can be used
to exclude stations that are known to lack data.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Event.n_closest_stations">
<span class="sig-name descname"><span class="pre">n_closest_stations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">available_stations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#Event.n_closest_stations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.Event.n_closest_stations" title="Link to this definition"></a></dt>
<dd><p>Adjust <cite>self.stations</cite> to the <cite>n</cite> closest stations.</p>
<p>Finds the <cite>n</cite> closest stations based on distance and modifies <cite>self.stations</cite> accordingly.
The instance’s properties will also change to reflect the updated station selection.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<em>int</em>) – The number of closest stations to fetch.</p></li>
<li><p><strong>available_stations</strong> (<em>list</em><em> of </em><em>strings</em><em>, </em><em>optional</em>) – The list of stations from which the closest stations are searched.
If certain stations are known to lack data, they can be excluded
from the closest stations selection. (default None)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.Event.n_samples">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_samples</span></span><a class="headerlink" href="#BPMF.dataset.Event.n_samples" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Event.pick_PS_phases">
<span class="sig-name descname"><span class="pre">pick_PS_phases</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">picker</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">duration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold_P</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold_S</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset_ot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-10.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase_on_comp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'1':</span> <span class="pre">'S',</span> <span class="pre">'2':</span> <span class="pre">'S',</span> <span class="pre">'E':</span> <span class="pre">'S',</span> <span class="pre">'N':</span> <span class="pre">'S',</span> <span class="pre">'Z':</span> <span class="pre">'P'}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">component_aliases</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'E':</span> <span class="pre">['E',</span> <span class="pre">'2'],</span> <span class="pre">'N':</span> <span class="pre">['N',</span> <span class="pre">'1'],</span> <span class="pre">'Z':</span> <span class="pre">['Z']}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upsampling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downsampling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_apriori_picks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">search_win_sec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_probability_time_series</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase_probability_time_series</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#Event.pick_PS_phases"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.Event.pick_PS_phases" title="Link to this definition"></a></dt>
<dd><p>Use <cite>picker</cite> to pick the P- and S-wave arrivals (Event class).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>picker</strong> (<em>func</em>) – Function that returns the time series of P- and S-wave probabilities:
<cite>ps_proba_time_series=f(seismograms)</cite>,
with shape of <cite>seismograms`=(n_stations, n_channels=3, n_times) and shape
of `ps_proba_time_series`=(n_stations, n_phases=2, n_times). The first channel,
`ps_proba_time_series[:, 0, :]</cite> is the P-wave probability, and the second,
<cite>ps_proba_time_series[:, 1, :]</cite>, is the S-wave probability.
Note: This function must include all preprocessing steps that may be required,
like chunking and normalization.</p></li>
<li><p><strong>duration</strong> (<em>float</em>) – Duration of the time window, in seconds, to process and search
for P and S wave arrivals.</p></li>
<li><p><strong>threshold_P</strong> (<em>float</em><em>, </em><em>optional</em>) – Threshold on P-wave probabilities to trigger the
identification of a P-wave arrival. (default 0.60)</p></li>
<li><p><strong>threshold_S</strong> (<em>float</em><em>, </em><em>optional</em>) – Threshold on S-wave probabilities to trigger the
identification of an S-wave arrival. (default 0.60)</p></li>
<li><p><strong>offset_ot</strong> (<em>float</em><em>, </em><em>optional</em>) – Offset in seconds to apply to the origin time.
(default cfg.BUFFER_EXTRACTED_EVENTS_SEC)</p></li>
<li><p><strong>phase_on_comp</strong> (<em>dict</em><em>, </em><em>optional</em>) – Dictionary defining the seismic phase extracted on each component.
For example, <cite>phase_on_comp[‘N’]</cite> specifies the phase extracted on
the north component.
(default {“N”: “S”, “1”: “S”, “E”: “S”, “2”: “S”, “Z”: “P”})</p></li>
<li><p><strong>component_aliases</strong> (<em>dict</em><em>, </em><em>optional</em>) – Dictionary mapping each component to a list of strings representing
aliases used for the same component. For example, <cite>component_aliases[‘N’] = [‘N’, ‘1’]</cite>
means that both the ‘N’ and ‘1’ channels will be mapped to the
Event’s ‘N’ channel.
(default {“N”: [“N”, “1”], “E”: [“E”, “2”], “Z”: [“Z”]})</p></li>
<li><p><strong>upsampling</strong> (<em>int</em><em>, </em><em>optional</em>) – Upsampling factor applied before calling PhaseNet. (default 1)</p></li>
<li><p><strong>downsampling</strong> (<em>int</em><em>, </em><em>optional</em>) – Downsampling factor applied before calling PhaseNet. (default 1)</p></li>
<li><p><strong>use_apriori_picks</strong> (<em>bool</em><em>, </em><em>optional</em>) – Flag indicating whether to use apriori picks for refining
the P and S wave picks. (default False)</p></li>
<li><p><strong>search_win_sec</strong> (<em>float</em><em>, </em><em>optional</em>) – Search window size, in seconds, used for refining
the P and S wave picks. (default 2.0)</p></li>
<li><p><strong>keep_probability_time_series</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the phase probability time series are stored in a
new class attribute, <cite>self.probability_time_series</cite>. (default True)</p></li>
<li><p><strong>phase_probability_time_series</strong> (<cite>BPMF.dataset.WaveformTransform</cite>, optional) – If different from None, the phase probabilities are not re-computed
but, instead, are fetched from an existing
<cite>BPMF.dataset.WaveformTransform</cite> instance. (default None)</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – Extra keyword arguments passed to <cite>Event.read_waveforms</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>PhaseNet must be used with 3-component data.</p></li>
<li><p>Results are stored in the object’s attribute <cite>self.picks</cite>.</p></li>
</ul>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.Event.pl_vmax_unc">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">pl_vmax_unc</span></span><a class="headerlink" href="#BPMF.dataset.Event.pl_vmax_unc" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Event.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(20,</span> <span class="pre">15)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gain</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Velocity</span> <span class="pre">($\\mu$m/s)'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_picks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_predicted_arrivals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_probabilities</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#Event.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.Event.plot" title="Link to this definition"></a></dt>
<dd><p>Plot the waveforms of the Event instance.</p>
<p>This function plots the waveforms associated with the Event instance. The
waveforms are plotted as subplots, with each subplot representing a station
and component combination. The start and end times of the waveforms are
determined to set the x-axis limits of each subplot. The picks and theoretical
arrival times associated with the Event are overlaid on the waveforms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>figsize</strong> (<em>tuple</em><em>, </em><em>optional</em>) – The figure size in inches, specified as a tuple (width, height). Defaults
to (20, 15).</p></li>
<li><p><strong>gain</strong> (<em>float</em><em>, </em><em>optional</em>) – The gain factor applied to the waveform data before plotting. Defaults to
1.0e6.</p></li>
<li><p><strong>stations</strong> (<em>list</em><em> of </em><em>str</em><em>, </em><em>optional</em>) – The list of station names for which to plot the waveforms. If None, all
stations associated with the Event are plotted. Defaults to None.</p></li>
<li><p><strong>ylabel</strong> (<em>str</em><em>, </em><em>optional</em>) – The label for the y-axis. Defaults to r’Velocity (microm/s)’.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments that are passed to the matplotlib plot
function.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fig</strong> – The Figure instance produced by this method.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>matplotlib.figure.Figure</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Event.read_from_file">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">read_from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">db_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hdf5_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_reader</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#Event.read_from_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.Event.read_from_file" title="Link to this definition"></a></dt>
<dd><p>Initialize an Event instance from <cite>filename</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>string</em><em>, </em><em>default to None</em>) – Name of the hdf5 file with the event’s data. If None, then
<cite>hdf5_file</cite> should be specified.</p></li>
<li><p><strong>db_path</strong> (string, default to <cite>cfg.INPUT_PATH</cite>) – Name of the directory where <cite>filename</cite> is located.</p></li>
<li><p><strong>gid</strong> (<em>string</em><em>, </em><em>default to None</em>) – If not None, this string is the hdf5’s group name of the event.</p></li>
<li><p><strong>hdf5_file</strong> (<cite>h5py.File</cite>, default to None) – If not None, is an opened file pointing directly at the subfolder of
interest.</p></li>
<li><p><strong>data_reader</strong> (<em>function</em><em>, </em><em>default to None</em>) – Function that takes a path and optional key-word arguments to read
data from this path and returns an <cite>obspy.Stream</cite> instance. If None,
<cite>data_reader</cite> has to be specified when calling <cite>read_waveforms</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>event</strong> – The <cite>Event</cite> instance defined by the data in <cite>filename</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>Event</cite> instance</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Event.read_waveforms">
<span class="sig-name descname"><span class="pre">read_waveforms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">duration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase_on_comp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'1':</span> <span class="pre">'S',</span> <span class="pre">'2':</span> <span class="pre">'S',</span> <span class="pre">'E':</span> <span class="pre">'S',</span> <span class="pre">'N':</span> <span class="pre">'S',</span> <span class="pre">'Z':</span> <span class="pre">'P'}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">component_aliases</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'E':</span> <span class="pre">['E',</span> <span class="pre">'2'],</span> <span class="pre">'N':</span> <span class="pre">['N',</span> <span class="pre">'1'],</span> <span class="pre">'Z':</span> <span class="pre">['Z']}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset_phase</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'P':</span> <span class="pre">1.0,</span> <span class="pre">'S':</span> <span class="pre">4.0}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_shifted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset_ot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-10.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_reader</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_threads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">reader_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#Event.read_waveforms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.Event.read_waveforms" title="Link to this definition"></a></dt>
<dd><p>Read waveform data (Event class).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>duration</strong> (<em>float</em>) – Duration of the extracted time windows in seconds.</p></li>
<li><p><strong>phase_on_comp</strong> (<em>dict</em><em>, </em><em>optional</em>) – Dictionary defining the seismic phase extracted on each component.
For example, <cite>phase_on_comp[‘N’]</cite> specifies the phase extracted on the north component.
(default {“N”: “S”, “1”: “S”, “E”: “S”, “2”: “S”, “Z”: “P”})</p></li>
<li><p><strong>component_aliases</strong> (<em>dict</em><em>, </em><em>optional</em>) – Dictionary mapping each component to a list of strings
representing aliases used for the same component.
For example, <cite>component_aliases[‘N’] = [‘N’, ‘1’]</cite> means that both the
‘N’ and ‘1’ channels will be mapped to the Event’s ‘N’ channel.
(default {“N”: [“N”, “1”], “E”: [“E”, “2”], “Z”: [“Z”]})</p></li>
<li><p><strong>offset_phase</strong> (<em>dict</em><em>, </em><em>optional</em>) – Dictionary defining when the time window starts with respect to the pick.
A positive offset means the window starts before the pick.
Not used if <cite>time_shifted</cite> is False. (default {“P”: 1.0, “S”: 4.0})</p></li>
<li><p><strong>time_shifted</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True (default), the moveouts are used to extract time windows
from specific seismic phases. If False, windows are simply extracted
with respect to the origin time.</p></li>
<li><p><strong>offset_ot</strong> (<em>float</em><em>, </em><em>optional</em>) – Only used if <cite>time_shifted</cite> is False.
Time in seconds taken before <cite>origin_time</cite>.
(default cfg.BUFFER_EXTRACTED_EVENTS_SEC)</p></li>
<li><p><strong>data_reader</strong> (<em>function</em><em>, </em><em>optional</em>) – Function that takes a path and optional keyword arguments to read
data from this path and returns an <cite>obspy.Stream</cite> instance.
If None (default), this function uses <cite>self.data_reader</cite> and
returns None if <cite>self.data_reader=None</cite>.</p></li>
<li><p><strong>n_threads</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of threads used to parallelize reading. Default is 1 (sequential reading).</p></li>
<li><p><strong>**reader_kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – Extra keyword arguments passed to the <cite>data_reader</cite> function.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>None</strong> – </p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>This function populates the <cite>self.traces</cite> attribute with the waveform data.</p></li>
<li><p>The <cite>duration</cite> and <cite>component_aliases</cite> are stored as attributes in the instance.</p></li>
<li><p>The <cite>phase_on_comp</cite> and <cite>offset_phase</cite> information is stored</p></li>
</ul>
<p>as auxiliary data in the instance.
- If <cite>reader_kwargs</cite> contains the “attach_response” key set to True,
traces without instrument response information are removed from <cite>self.traces</cite>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Event.relocate">
<span class="sig-name descname"><span class="pre">relocate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">routine</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'NLLoc'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#Event.relocate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.Event.relocate" title="Link to this definition"></a></dt>
<dd><p>Wrapper function for earthquake relocation using multiple methods.</p>
<p>This function serves as an interface for the earthquake relocation process
using different relocation routines. The routine to be used is specified
by the <cite>routine</cite> parameter. All keyword arguments are passed to the
corresponding routine.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>routine</strong> (<em>str</em><em>, </em><em>optional</em>) – <p>Method used for the relocation. Available options are:
- ‘NLLoc’: Calls the <cite>relocate_NLLoc</cite> method and requires the event</p>
<blockquote>
<div><p>object to have the <cite>picks</cite> attribute.</p>
</div></blockquote>
<ul class="simple">
<li><p>’beam’: Calls the <cite>relocate_beam</cite> method.</p></li>
</ul>
<p>Default is ‘NLLoc’.</p>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The <cite>relocate</cite> function acts as a wrapper that allows for flexibility in
choosing the relocation routine.</p></li>
<li><p>Depending on the specified <cite>routine</cite>, the function calls the corresponding
relocation method with the provided arguments and keyword arguments.</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Event.relocate_NLLoc">
<span class="sig-name descname"><span class="pre">relocate_NLLoc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'EDT'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epicentral_dist_km_S</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_to_gaussian</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cleanup_out_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#Event.relocate_NLLoc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.Event.relocate_NLLoc" title="Link to this definition"></a></dt>
<dd><p>Relocate the event using NonLinLoc (NLLoc) based on the provided picks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stations</strong> (<em>list</em><em> of </em><em>str</em><em>, </em><em>optional</em>) – Names of the stations to include in the relocation process. If None,
all stations in <cite>self.stations</cite> are used. Default is None.</p></li>
<li><p><strong>method</strong> (<em>str</em><em>, </em><em>optional</em>) – Optimization algorithm used by NonLinLoc. Available options are:
‘GAU_ANALYTIC’, ‘EDT’, ‘EDT_OT’, ‘EDT_OT_WT_ML’. Refer to NonLinLoc’s
documentation for more details. Default is ‘EDT’.</p></li>
<li><p><strong>max_epicentral_dist_km_S</strong> (<em>float</em><em>, </em><em>optional</em>) – If not None, only stations closer than <cite>max_epicentral_dist_km_S</cite> from the
prior location contribute to S picks. Defaults to None.</p></li>
<li><p><strong>default_to_gaussian</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the gaussian approximation of the location pdf is used when the
search for the maximum likelihood fails. Defaults to False.</p></li>
<li><p><strong>verbose</strong> (<em>int</em><em>, </em><em>optional</em>) – Verbosity level of NonLinLoc. If greater than 0, NonLinLoc’s outputs
are printed to the standard output. Default is 0.</p></li>
<li><p><strong>cleanup_out_dir</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, NLLoc’s output files are deleted after reading the relevant
information. Default is True.</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – Additional keyword arguments for <cite>BPMF.NLLoc_utils.write_NLLoc_control</cite>.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The event’s attributes, including the origin time and location, are updated.</p></li>
<li><p>The theoretical arrival times are attached to the event in <cite>Event.arrival_times</cite>.</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Event.relocate_beam">
<span class="sig-name descname"><span class="pre">relocate_beam</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">beamformer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">duration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">60.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset_ot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-10.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase_on_comp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'1':</span> <span class="pre">'S',</span> <span class="pre">'2':</span> <span class="pre">'S',</span> <span class="pre">'E':</span> <span class="pre">'S',</span> <span class="pre">'N':</span> <span class="pre">'S',</span> <span class="pre">'Z':</span> <span class="pre">'P'}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">component_aliases</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'E':</span> <span class="pre">['E',</span> <span class="pre">'2'],</span> <span class="pre">'N':</span> <span class="pre">['N',</span> <span class="pre">'1'],</span> <span class="pre">'Z':</span> <span class="pre">['Z']}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">waveform_features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uncertainty_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'spatial'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">restricted_domain_side_km</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cpu'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#Event.relocate_beam"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.Event.relocate_beam" title="Link to this definition"></a></dt>
<dd><p>Use a Beamformer instance for backprojection to relocate the event.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>beamformer</strong> (<a class="reference internal" href="template_search.html#BPMF.template_search.Beamformer" title="BPMF.template_search.Beamformer"><em>BPMF.template_search.Beamformer</em></a>) – Beamformer instance used for backprojection.</p></li>
<li><p><strong>duration</strong> (<em>float</em><em>, </em><em>optional</em>) – Duration, in seconds, of the extracted time windows. Default is 60.0 seconds.</p></li>
<li><p><strong>offset_ot</strong> (<em>float</em><em>, </em><em>optional</em>) – Time in seconds taken before the <cite>origin_time</cite>. Only used if <cite>time_shifted</cite> is False.
Default is <cite>cfg.BUFFER_EXTRACTED_EVENTS_SEC</cite>.</p></li>
<li><p><strong>phase_on_comp</strong> (<em>dict</em><em>, </em><em>optional</em>) – Dictionary defining which seismic phase is extracted on each component.
For example, <cite>phase_on_comp[‘N’]</cite> gives the phase extracted on the north component.
Default is <cite>{“N”: “S”, “1”: “S”, “E”: “S”, “2”: “S”, “Z”: “P”}</cite>.</p></li>
<li><p><strong>component_aliases</strong> (<em>dict</em><em>, </em><em>optional</em>) – Dictionary where each entry is a list of strings. <cite>component_aliases[comp]</cite>
is the list of all aliases used for the same component ‘comp’. For example,
<cite>component_aliases[‘N’] = [‘N’, ‘1’]</cite> means that both the ‘N’ and ‘1’ channels
will be mapped to the Event’s ‘N’ channel. Default is <cite>{“N”: [“N”, “1”],
“E”: [“E”, “2”], “Z”: [“Z”]}</cite>.</p></li>
<li><p><strong>waveform_features</strong> (<em>numpy.ndarray</em><em>, </em><em>optional</em>) – If not None, it must be a <cite>(num_stations, num_channels, num_time_samples)</cite>
numpy.ndarray containing waveform features or characteristic functions
that are backprojected onto the grid of theoretical seismic sources.
Default is None.</p></li>
<li><p><strong>restricted_domain_side_km</strong> (<em>float</em><em>, </em><em>optional</em>) – The location uncertainties are computed on the full 3D beam at the time when
the 4D beam achieves its maximum over the <cite>duration</cite> seconds. To avoid having
grid-size-dependent uncertainties, it is useful to truncate the domain around
the location of the maximum beam. This parameter controls the size of the
truncated domain. Default is 100.0 km.</p></li>
<li><p><strong>device</strong> (<em>str</em><em>, </em><em>optional</em>) – Device to be used for computation. Must be either ‘cpu’ (default) or ‘gpu’.</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – Additional keyword arguments.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The function updates the <cite>origin_time</cite>, <cite>longitude</cite>, <cite>latitude</cite>, and <cite>depth</cite>
attributes of the event based on the maximum focusing of the beamformer.</p></li>
<li><p>Location uncertainties are estimated based on the computed likelihood,
a restricted domain, and the location coordinates.</p></li>
<li><p>The estimated uncertainties can be accessed through the <cite>Event</cite>’s</p></li>
</ul>
<p>properties <cite>Event.hmax_unc</cite>, <cite>Event.hmin_unc</cite>, <cite>Event.vmax_unc</cite>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Event.remove_distant_stations">
<span class="sig-name descname"><span class="pre">remove_distant_stations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_distance_km</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#Event.remove_distant_stations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.Event.remove_distant_stations" title="Link to this definition"></a></dt>
<dd><p>Remove picks on stations that are further than a given distance.</p>
<p>This function removes picks on stations that are located at a distance
greater than the specified maximum distance. The distance between the source
and each station is computed using the <cite>source_receiver_dist</cite> attribute.
Picks on stations beyond the maximum distance are set to NaN.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>max_distance_km</strong> (<em>float</em><em>, </em><em>optional</em>) – Maximum distance, in kilometers, beyond which picks are considered to be
on stations that are too distant. Picks on stations with a distance
greater than this threshold will be set to NaN. Default is 50.0.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The function checks if the <cite>source_receiver_dist</cite> attribute is present in
the object. If it is not available, an informative message is printed and
the function returns.</p></li>
<li><p>For each station in <cite>stations</cite>, the distance between the source and the
station is retrieved from the <cite>source_receiver_dist</cite> attribute.</p></li>
<li><p>If the distance of a station is greater than the specified maximum distance
(<cite>max_distance_km</cite>), the picks associated with that station are set to NaN.</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Event.remove_outlier_picks">
<span class="sig-name descname"><span class="pre">remove_outlier_picks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_diff_percent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">25.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#Event.remove_outlier_picks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.Event.remove_outlier_picks" title="Link to this definition"></a></dt>
<dd><p>Remove picks that are too far from the predicted arrival times.</p>
<p>Picks that have a difference exceeding the specified threshold between the
picked arrival time and the predicted arrival time are considered outliers
and are removed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>max_diff_percent</strong> (<em>float</em><em>, </em><em>optional</em>) – Maximum allowable difference, in percentage, between the picked and
predicted arrival times. Picks with a difference greater than this
threshold will be considered outliers and removed. Default is 25.0.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Event.set_arrival_times_from_moveouts">
<span class="sig-name descname"><span class="pre">set_arrival_times_from_moveouts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#Event.set_arrival_times_from_moveouts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.Event.set_arrival_times_from_moveouts" title="Link to this definition"></a></dt>
<dd><p>Build arrival times assuming at = ot + mv.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Event.set_aux_data">
<span class="sig-name descname"><span class="pre">set_aux_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">aux_data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#Event.set_aux_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.Event.set_aux_data" title="Link to this definition"></a></dt>
<dd><p>Adds any extra data to the Event instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>aux_data</strong> (<em>dictionary</em>) – Dictionary with any auxiliary data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Event.set_availability">
<span class="sig-name descname"><span class="pre">set_availability</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">components</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['N',</span> <span class="pre">'E',</span> <span class="pre">'Z']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">component_aliases</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'E':</span> <span class="pre">['E',</span> <span class="pre">'2'],</span> <span class="pre">'N':</span> <span class="pre">['N',</span> <span class="pre">'1'],</span> <span class="pre">'Z':</span> <span class="pre">['Z']}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#Event.set_availability"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.Event.set_availability" title="Link to this definition"></a></dt>
<dd><p>Set the data availability.</p>
<p>A station is available if at least one station has non-zero data. The
availability is then accessed via the property <cite>self.availability</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>stations</strong> (<em>list</em><em> of </em><em>strings</em><em> or </em><em>numpy.ndarray</em><em>, </em><em>default to None</em>) – Names of the stations on which we check availability. If None, use
<cite>self.stations</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Event.set_component_aliases">
<span class="sig-name descname"><span class="pre">set_component_aliases</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">component_aliases</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#Event.set_component_aliases"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.Event.set_component_aliases" title="Link to this definition"></a></dt>
<dd><p>Set or modify the <cite>component_aliases</cite> attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>component_aliases</strong> (<em>Dictionary</em>) – Each entry of the dictionary is a list of strings.
<cite>component_aliases[comp]</cite> is the list of all aliases used for
the same component ‘comp’. For example, <cite>component_aliases[‘N’] =
[‘N’, ‘1’]</cite> means that both the ‘N’ and ‘1’ channels will be mapped
to the Event’s ‘N’ channel.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Event.set_components">
<span class="sig-name descname"><span class="pre">set_components</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">components</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#Event.set_components"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.Event.set_components" title="Link to this definition"></a></dt>
<dd><p>Set the list of components.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>components</strong> (<em>list</em><em> of </em><em>strings</em>) – The names of the components on which the <cite>Template</cite> instance will
work after this call to <cite>self.set_components</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Event.set_moveouts_to_empirical_times">
<span class="sig-name descname"><span class="pre">set_moveouts_to_empirical_times</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#Event.set_moveouts_to_empirical_times"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.Event.set_moveouts_to_empirical_times" title="Link to this definition"></a></dt>
<dd><p>Set moveouts equal to picks, if available.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Event.set_moveouts_to_theoretical_times">
<span class="sig-name descname"><span class="pre">set_moveouts_to_theoretical_times</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#Event.set_moveouts_to_theoretical_times"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.Event.set_moveouts_to_theoretical_times" title="Link to this definition"></a></dt>
<dd><p>Set moveouts equal to theoretical arrival times, if available.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Event.set_source_receiver_dist">
<span class="sig-name descname"><span class="pre">set_source_receiver_dist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">network</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#Event.set_source_receiver_dist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.Event.set_source_receiver_dist" title="Link to this definition"></a></dt>
<dd><p>Set source-receiver distances using the provided <cite>network</cite>.</p>
<p>This function calculates the hypocentral and epicentral distances between
the event’s source location and the stations in the given network. It
stores the distances as attributes of the event object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>network</strong> (<a class="reference internal" href="#BPMF.dataset.Network" title="BPMF.dataset.Network"><em>dataset.Network</em></a>) – The <cite>Network</cite> instance containing the station coordinates to use in
the source-receiver distance calculation.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The function uses the <cite>BPMF.utils.compute_distances</cite> function to compute
both hypocentral and epicentral distances between the event’s source
location and the stations in the network.</p></li>
<li><p>The computed distances can be accessed with the <cite>Event</cite>’s properties</p></li>
</ul>
<p><cite>Event.source_receiver_dist</cite> and <cite>Event.source_receiver_epicentral_dist</cite>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.Event.snr">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">snr</span></span><a class="headerlink" href="#BPMF.dataset.Event.snr" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.Event.source_receiver_dist">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">source_receiver_dist</span></span><a class="headerlink" href="#BPMF.dataset.Event.source_receiver_dist" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.Event.source_receiver_epicentral_dist">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">source_receiver_epicentral_dist</span></span><a class="headerlink" href="#BPMF.dataset.Event.source_receiver_epicentral_dist" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.Event.sr">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sr</span></span><a class="headerlink" href="#BPMF.dataset.Event.sr" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Event.trim_waveforms">
<span class="sig-name descname"><span class="pre">trim_waveforms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">starttime</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">endtime</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#Event.trim_waveforms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.Event.trim_waveforms" title="Link to this definition"></a></dt>
<dd><p>Trim waveforms to a specified time window.</p>
<p>This function trims the waveforms in the event’s <cite>traces</cite> attribute to the
specified time window. It ensures that all traces have the same start time
by adjusting the start time if necessary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>starttime</strong> (<em>str</em><em> or </em><em>datetime</em><em>, </em><em>optional</em>) – The start time of the desired time window. If None, the event’s <cite>date</cite>
attribute is used as the start time. Default is None.</p></li>
<li><p><strong>endtime</strong> (<em>str</em><em> or </em><em>datetime</em><em>, </em><em>optional</em>) – The end time of the desired time window. If None, the end time is set
as <cite>self.date</cite> + <cite>self.duration</cite>, where <cite>self.date</cite> is the event’s date
attribute and <cite>self.duration</cite> is the event’s duration attribute.
Default is None.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Event.update_aux_data_database">
<span class="sig-name descname"><span class="pre">update_aux_data_database</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#Event.update_aux_data_database"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.Event.update_aux_data_database" title="Link to this definition"></a></dt>
<dd><p>Update the auxiliary data in the database with new elements from <cite>self.aux_data</cite>.</p>
<p>This function adds new elements from the <cite>self.aux_data</cite> attribute to the database
located at <cite>path_database</cite>. If the element already exists in the database
and <cite>overwrite</cite> is False, it skips the element. If <cite>overwrite</cite> is True, it
overwrites the existing data in the database with the new data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>overwrite</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, overwrite existing data in the database. If False (default),
skip existing elements and do not modify the database.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>If any error occurs during the process, the function removes the lock file and
raises the exception.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>Exception</strong> – If an error occurs while updating the database, the function raises the
    exception after removing the lock file.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Event.update_picks">
<span class="sig-name descname"><span class="pre">update_picks</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#Event.update_picks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.Event.update_picks" title="Link to this definition"></a></dt>
<dd><p>Update the picks with respect to the current origin time.</p>
<p>This function updates the picks of each station with respect to the current
origin time of the event. It computes the relative pick times by subtracting
the origin time from the absolute pick times and update the
<cite>picks</cite> attribute of the event.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Event.update_travel_times">
<span class="sig-name descname"><span class="pre">update_travel_times</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#Event.update_travel_times"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.Event.update_travel_times" title="Link to this definition"></a></dt>
<dd><p>Update the travel times with respect to the current origin time.</p>
<p>This function updates the travel times of each station and phase with respect
to the current origin time of the event. It adjusts the propagation times
by subtracting the origin time from the absolute times and update the
<cite>arrival_times</cite> attribute of the event.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.Event.vmax_unc">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">vmax_unc</span></span><a class="headerlink" href="#BPMF.dataset.Event.vmax_unc" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.Event.waveforms_arr">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">waveforms_arr</span></span><a class="headerlink" href="#BPMF.dataset.Event.waveforms_arr" title="Link to this definition"></a></dt>
<dd><p>Return traces in numpy.ndarray.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Event.write">
<span class="sig-name descname"><span class="pre">write</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">db_filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">db_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_waveforms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hdf5_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#Event.write"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.Event.write" title="Link to this definition"></a></dt>
<dd><p>Write the event information to an HDF5 file.</p>
<p>This function writes the event information, including waveform data if
specified, to an HDF5 file. The event information is stored in a specific
group within the file. The function uses the <cite>h5py</cite> module to interact
with the HDF5 file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>db_filename</strong> (<em>str</em>) – Name of the HDF5 file storing the event information.</p></li>
<li><p><strong>db_path</strong> (<em>str</em><em>, </em><em>optional</em>) – Path to the directory where the HDF5 file is located. Defaults to
<cite>cfg.OUTPUT_PATH</cite>.</p></li>
<li><p><strong>save_waveforms</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, save the waveform data associated with the event in the HDF5
file. Defaults to False.</p></li>
<li><p><strong>gid</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of the HDF5 group where the event will be stored. If <cite>gid</cite> is None,
the event is stored directly at the root of the HDF5 file. Defaults to
None.</p></li>
<li><p><strong>hdf5_file</strong> (<em>h5py.File</em><em>, </em><em>optional</em>) – An opened HDF5 file object pointing directly to the subfolder of
interest. If provided, the <cite>db_path</cite> parameter is ignored. Defaults to
None.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The function uses the <cite>read_write_waiting_list</cite> function from the <cite>utils</cite>
module to handle the writing operation in a thread-safe manner. The actual
writing is performed by the <cite>_write</cite> method, which is called with the
appropriate parameters.</p></li>
<li><p>The <cite>read_write_waiting_list</cite> function handles the synchronization and
queueing of write operations to avoid conflicts when multiple processes
try to write to the same file simultaneously. The function waits for a
lock before executing the <cite>func</cite> partial function, which performs the
actual writing operation. <strong>BUT</strong> the queueing is still not bullet-proof.</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Event.zero_out_clipped_waveforms">
<span class="sig-name descname"><span class="pre">zero_out_clipped_waveforms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kurtosis_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#Event.zero_out_clipped_waveforms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.Event.zero_out_clipped_waveforms" title="Link to this definition"></a></dt>
<dd><p>Find waveforms with anomalous statistic and zero them out.</p>
<p>This function identifies waveforms with a kurtosis value below the specified
threshold as anomalous and zeros out their data. The kurtosis of a waveform
is a measure of its statistical distribution, with a value of 0 indicating a
Gaussian distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>kurtosis_threshold</strong> (<em>float</em><em>, </em><em>optional</em>) – Threshold below which the kurtosis is considered anomalous. Waveforms
with a kurtosis value lower than this threshold will have their data
zeroed out. Default is -1.0.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>This is an oversimplified technique to find clipped waveforms.</p></li>
</ul>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="BPMF.dataset.EventGroup">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">BPMF.dataset.</span></span><span class="sig-name descname"><span class="pre">EventGroup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">events</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">network</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#EventGroup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.EventGroup" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#BPMF.dataset.Family" title="BPMF.dataset.Family"><code class="xref py py-class docutils literal notranslate"><span class="pre">Family</span></code></a></p>
<p>A class for a group of events.</p>
<p>Each event is represented by a <cite>dataset.Event</cite> instance.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="BPMF.dataset.EventGroup.events">
<span class="sig-name descname"><span class="pre">events</span></span><a class="headerlink" href="#BPMF.dataset.EventGroup.events" title="Link to this definition"></a></dt>
<dd><p>List of <cite>dataset.Event</cite> instances constituting the group.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="BPMF.dataset.EventGroup.network">
<span class="sig-name descname"><span class="pre">network</span></span><a class="headerlink" href="#BPMF.dataset.EventGroup.network" title="Link to this definition"></a></dt>
<dd><p>The <cite>Network</cite> instance used to query consistent data across all events.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>dataset.Network</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.EventGroup.SVDWF_stack">
<span class="sig-name descname"><span class="pre">SVDWF_stack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freqmin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freqmax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_rate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expl_var</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_singular_values</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wiener_filter_colsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#EventGroup.SVDWF_stack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.EventGroup.SVDWF_stack" title="Link to this definition"></a></dt>
<dd><p>Apply Singular Value Decomposition Waveform Filtering (SVDWF) and stack the waveforms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>freqmin</strong> (<em>float</em>) – Minimum frequency in Hz for the bandpass filter.</p></li>
<li><p><strong>freqmax</strong> (<em>float</em>) – Maximum frequency in Hz for the bandpass filter.</p></li>
<li><p><strong>sampling_rate</strong> (<em>float</em>) – Sampling rate in Hz of the waveforms.</p></li>
<li><p><strong>expl_var</strong> (<em>float</em><em>, </em><em>default 0.4</em>) – Explained variance ratio threshold for retaining singular values.</p></li>
<li><p><strong>max_singular_values</strong> (<em>int</em><em>, </em><em>default 5</em>) – Maximum number of singular values to retain during SVDWF.</p></li>
<li><p><strong>wiener_filter_colsize</strong> (<em>int</em><em>, </em><em>default None</em>) – Size of the column blocks used for the Wiener filter.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>See: Moreau, L., Stehly, L., Boué, P., Lu, Y., Larose, E., &amp; Campillo, M. (2017).
Improving ambient noise correlation functions with an SVD-based Wiener filter.
Geophysical Journal International, 211(1), 418-426.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.EventGroup.n_events">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_events</span></span><a class="headerlink" href="#BPMF.dataset.EventGroup.n_events" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.EventGroup.read_waveforms">
<span class="sig-name descname"><span class="pre">read_waveforms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">duration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_shifted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#EventGroup.read_waveforms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.EventGroup.read_waveforms" title="Link to this definition"></a></dt>
<dd><p>Call <cite>dataset.Event.read_waveform</cite> with each event.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>duration</strong> (<em>float</em>) – Duration of the waveform to read, in seconds.</p></li>
<li><p><strong>time_shifted</strong> (<em>bool</em><em>, </em><em>default False</em>) – Whether to apply time shifting to the waveforms.</p></li>
<li><p><strong>progress</strong> (<em>bool</em><em>, </em><em>default False</em>) – Whether to display progress information during waveform reading.</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em>) – Additional keyword arguments to pass to <cite>dataset.Event.read_waveforms</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="BPMF.dataset.Family">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">BPMF.dataset.</span></span><span class="sig-name descname"><span class="pre">Family</span></span><a class="reference internal" href="../../_modules/BPMF/dataset.html#Family"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.Family" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>An abstract class for several subclasses.</p>
<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.Family.components">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">components</span></span><a class="headerlink" href="#BPMF.dataset.Family.components" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Family.get_moveouts_arr">
<span class="sig-name descname"><span class="pre">get_moveouts_arr</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#Family.get_moveouts_arr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.Family.get_moveouts_arr" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Family.get_waveforms_arr">
<span class="sig-name descname"><span class="pre">get_waveforms_arr</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#Family.get_waveforms_arr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.Family.get_waveforms_arr" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.Family.moveouts_arr">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">moveouts_arr</span></span><a class="headerlink" href="#BPMF.dataset.Family.moveouts_arr" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Family.normalize">
<span class="sig-name descname"><span class="pre">normalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rms'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#Family.normalize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.Family.normalize" title="Link to this definition"></a></dt>
<dd><p>Normalize the template waveforms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>method</strong> (<em>string</em><em>, </em><em>default to 'rms'</em>) – Either ‘rms’ (default) or ‘max’.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Family.read_waveforms">
<em class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">read_waveforms</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#Family.read_waveforms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.Family.read_waveforms" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Family.set_network">
<span class="sig-name descname"><span class="pre">set_network</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">network</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#Family.set_network"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.Family.set_network" title="Link to this definition"></a></dt>
<dd><p>Update <cite>self.network</cite> to the new desired <cite>network</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>network</strong> (<cite>dataset.Network</cite> instance) – The <cite>Network</cite> instance used to query consistent data accross all
templates.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Family.set_source_receiver_dist">
<span class="sig-name descname"><span class="pre">set_source_receiver_dist</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#Family.set_source_receiver_dist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.Family.set_source_receiver_dist" title="Link to this definition"></a></dt>
<dd><p>Compute the source-receiver distances for template.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.Family.stations">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">stations</span></span><a class="headerlink" href="#BPMF.dataset.Family.stations" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.Family.waveforms_arr">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">waveforms_arr</span></span><a class="headerlink" href="#BPMF.dataset.Family.waveforms_arr" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="BPMF.dataset.Network">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">BPMF.dataset.</span></span><span class="sig-name descname"><span class="pre">Network</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">network_file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#Network"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.Network" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Station metadata.</p>
<p>Contains station metadata.</p>
<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Network.box">
<span class="sig-name descname"><span class="pre">box</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lat_min</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon_min</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon_max</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#Network.box"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.Network.box" title="Link to this definition"></a></dt>
<dd><p>Geographical selection of sub-network.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lat_min</strong> (<em>scalar</em><em>, </em><em>float</em>) – Minimum latitude of the box.</p></li>
<li><p><strong>lat_max</strong> (<em>scalar</em><em>, </em><em>float</em>) – Maximum latitude of the box.</p></li>
<li><p><strong>lon_min</strong> (<em>scalar</em><em>, </em><em>float</em>) – Minimum longitude of the box.</p></li>
<li><p><strong>lon_max</strong> (<em>scalar</em><em>, </em><em>float</em>) – Maximum longitude of the box.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>subnet</strong> – The Network instance restricted to the relevant stations.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Network instance</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Network.datelist">
<span class="sig-name descname"><span class="pre">datelist</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#Network.datelist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.Network.datelist" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.Network.depth">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">depth</span></span><a class="headerlink" href="#BPMF.dataset.Network.depth" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.Network.elevation">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">elevation</span></span><a class="headerlink" href="#BPMF.dataset.Network.elevation" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.Network.interstation_distances">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">interstation_distances</span></span><a class="headerlink" href="#BPMF.dataset.Network.interstation_distances" title="Link to this definition"></a></dt>
<dd><p>Compute the distance between all station pairs.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>A pandas DataFrame containing the interstation distances.</dt><dd><p>The rows and columns represent the station names, and the
values represent the distances in kilometers.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.Network.latitude">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">latitude</span></span><a class="headerlink" href="#BPMF.dataset.Network.latitude" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.Network.longitude">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">longitude</span></span><a class="headerlink" href="#BPMF.dataset.Network.longitude" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.Network.n_components">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_components</span></span><a class="headerlink" href="#BPMF.dataset.Network.n_components" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.Network.n_stations">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_stations</span></span><a class="headerlink" href="#BPMF.dataset.Network.n_stations" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.Network.networks">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">networks</span></span><a class="headerlink" href="#BPMF.dataset.Network.networks" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Network.plot_map">
<span class="sig-name descname"><span class="pre">plot_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(20,</span> <span class="pre">10)</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#Network.plot_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.Network.plot_map" title="Link to this definition"></a></dt>
<dd><p>Plot stations on map.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> (<cite>plt.Axes</cite>, default to None) – If None, create a new <cite>plt.Figure</cite> and <cite>plt.Axes</cite> instances. If
speficied by user, use the provided instance to plot.</p></li>
<li><p><strong>figsize</strong> (<em>tuple</em><em> of </em><em>floats</em><em>, </em><em>default to</em><em> (</em><em>20</em><em>, </em><em>10</em><em>)</em>) – Size, in inches, of the figure (width, height).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fig</strong> – The map with seismic stations.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>plt.Figure</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Network.read">
<span class="sig-name descname"><span class="pre">read</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#Network.read"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.Network.read" title="Link to this definition"></a></dt>
<dd><p>Reads the metadata from the file at self.where</p>
<p>Note: This function can be modified to match the user’s
data convention.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.Network.station_indexes">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">station_indexes</span></span><a class="headerlink" href="#BPMF.dataset.Network.station_indexes" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.Network.stations">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">stations</span></span><a class="headerlink" href="#BPMF.dataset.Network.stations" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Network.stations_idx">
<span class="sig-name descname"><span class="pre">stations_idx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stations</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#Network.stations_idx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.Network.stations_idx" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Network.subset">
<span class="sig-name descname"><span class="pre">subset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stations</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">components</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'keep'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#Network.subset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.Network.subset" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stations</strong> (<em>list</em><em> or </em><em>array</em><em> of </em><em>strings</em>) – Stations to keep or discard, depending on the method.</p></li>
<li><p><strong>components</strong> (<em>list</em><em> or </em><em>array</em><em> of </em><em>strings</em>) – Components to keep or discard, depending on the method.</p></li>
<li><p><strong>method</strong> (<em>string</em><em>, </em><em>default to 'keep'</em>) – Should be ‘keep’ or ‘discard’.
If ‘keep’, the stations and components provided to
this function are what will be left in the subnetwork.
If ‘discard’, the stations and components provided to
this function are what won’t be featured in the
subnetwork.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>subnetwork</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="BPMF.dataset.Stack">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">BPMF.dataset.</span></span><span class="sig-name descname"><span class="pre">Stack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stacked_traces</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">moveouts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stations</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phases</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latitude</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">longitude</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">component_aliases</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'E':</span> <span class="pre">['E',</span> <span class="pre">'2'],</span> <span class="pre">'N':</span> <span class="pre">['N',</span> <span class="pre">'1'],</span> <span class="pre">'Z':</span> <span class="pre">['Z']}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">components</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['N',</span> <span class="pre">'E',</span> <span class="pre">'Z']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aux_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filtered_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#Stack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.Stack" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#BPMF.dataset.Event" title="BPMF.dataset.Event"><code class="xref py py-class docutils literal notranslate"><span class="pre">Event</span></code></a></p>
<p>A modification of the Event class for stacked events.</p>
<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Stack.pick_PS_phases_family_mode">
<span class="sig-name descname"><span class="pre">pick_PS_phases_family_mode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">picker</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">duration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold_P</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold_S</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase_on_comp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'1':</span> <span class="pre">'S',</span> <span class="pre">'2':</span> <span class="pre">'S',</span> <span class="pre">'E':</span> <span class="pre">'S',</span> <span class="pre">'N':</span> <span class="pre">'S',</span> <span class="pre">'Z':</span> <span class="pre">'P'}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upsampling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downsampling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#Stack.pick_PS_phases_family_mode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.Stack.pick_PS_phases_family_mode" title="Link to this definition"></a></dt>
<dd><p>Use <cite>picker</cite> to pick the P- and S-wave arrivals (Stack class).</p>
<p>This method picks P- and S-wave arrivals on every 3-component seismogram
in <cite>self.filtered_data</cite>. Thus, potentially many picks can be found on every
station and all of them returned in <cite>self.picks</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>picker</strong> (<em>func</em>) – Function that returns the time series of P- and S-wave probabilities:
<cite>ps_proba_time_series=f(seismograms)</cite>,
with shape of <cite>seismograms`=(n_stations, n_channels=3, n_times) and shape
of `ps_proba_time_series`=(n_stations, n_phases=2, n_times). The first channel,
`ps_proba_time_series[:, 0, :]</cite> is the P-wave probability, and the second,
<cite>ps_proba_time_series[:, 1, :]</cite>, is the S-wave probability.
Note: This function must include all preprocessing steps that may be required,
like chunking and normalization.</p></li>
<li><p><strong>duration</strong> (<em>float</em>) – Duration, in seconds, of the time window to process to search
for P and S wave arrivals.</p></li>
<li><p><strong>threshold_P</strong> (<em>float</em><em>, </em><em>optional</em>) – Threshold on P-wave probabilities to trigger the identification
of a P-wave arrival. Default: 0.60</p></li>
<li><p><strong>threshold_S</strong> (<em>float</em><em>, </em><em>optional</em>) – Threshold on S-wave probabilities to trigger the identification
of an S-wave arrival. Default: 0.60</p></li>
<li><p><strong>phase_on_comp</strong> (<em>dict</em><em>, </em><em>optional</em>) – Dictionary defining which seismic phase is extracted on each component.
For example, <cite>phase_on_comp[‘N’]</cite> gives the phase that is extracted on
the north component.</p></li>
<li><p><strong>upsampling</strong> (<em>int</em><em>, </em><em>optional</em>) – Upsampling factor applied before calling PhaseNet. Default: 1</p></li>
<li><p><strong>downsampling</strong> (<em>int</em><em>, </em><em>optional</em>) – Downsampling factor applied before calling PhaseNet. Default: 1</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>PhaseNet must be used with 3-comp data.</p></li>
<li><p>If <cite>self.filtered_data</cite> does not exist, <cite>self.pick_PS_phases</cite> is used</p></li>
</ul>
<p>on the stacked traces.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Stack.read_waveforms">
<span class="sig-name descname"><span class="pre">read_waveforms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">duration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase_on_comp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'1':</span> <span class="pre">'S',</span> <span class="pre">'2':</span> <span class="pre">'S',</span> <span class="pre">'E':</span> <span class="pre">'S',</span> <span class="pre">'N':</span> <span class="pre">'S',</span> <span class="pre">'Z':</span> <span class="pre">'P'}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset_phase</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'P':</span> <span class="pre">1.0,</span> <span class="pre">'S':</span> <span class="pre">4.0}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_shifted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset_ot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-10.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#Stack.read_waveforms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.Stack.read_waveforms" title="Link to this definition"></a></dt>
<dd><p>Read waveform data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>duration</strong> (<em>float</em>) – Duration, in seconds, of the extracted time windows.</p></li>
<li><p><strong>phase_on_comp</strong> (<em>dict</em><em>, </em><em>optional</em>) – Dictionary defining which seismic phase is extracted on each component.
For example, <cite>phase_on_comp[‘N’]</cite> gives the phase that is extracted on the
north component.</p></li>
<li><p><strong>offset_phase</strong> (<em>dict</em><em>, </em><em>optional</em>) – Dictionary defining when the time window starts with respect to the pick.
A positive offset means the window starts before the pick. Not used if
<cite>time_shifted</cite> is False.</p></li>
<li><p><strong>time_shifted</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the moveouts are used to extract time windows from specific seismic
phases. If False, windows are simply extracted with respect to the origin time.</p></li>
<li><p><strong>offset_ot</strong> (<em>float</em><em>, </em><em>optional</em>) – Only used if <cite>time_shifted</cite> is False. Time, in seconds, taken before <cite>origin_time</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The waveforms are read from <cite>self.stacked_waveforms</cite> and are formatted as
obspy.Stream instances that populate the <cite>self.traces</cite> attribute.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="BPMF.dataset.Template">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">BPMF.dataset.</span></span><span class="sig-name descname"><span class="pre">Template</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">origin_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">moveouts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stations</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phases</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">template_filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">template_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latitude</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">longitude</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">components</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['N',</span> <span class="pre">'E',</span> <span class="pre">'Z']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#Template"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.Template" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#BPMF.dataset.Event" title="BPMF.dataset.Event"><code class="xref py py-class docutils literal notranslate"><span class="pre">Event</span></code></a></p>
<p>A class for template events.</p>
<p>The Template class is a subclass of the Event class and is specifically designed
for template events. It inherits all the attributes and methods of the Event
class and adds additional functionality specific to template events.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>origin_time</strong> (<em>str</em><em> or </em><em>datetime</em>) – The origin time of the template event. Can be specified as a string in
ISO 8601 format or as a datetime object.</p></li>
<li><p><strong>moveouts</strong> (<em>pandas.DataFrame</em>) – The moveout table containing the travel time information for the template
event. The moveouts table should have the following columns: ‘Phase’, ‘Station’,
‘Distance’, and ‘TravelTime’.</p></li>
<li><p><strong>stations</strong> (<em>list</em><em> of </em><em>str</em>) – The list of station names associated with the template event.</p></li>
<li><p><strong>phases</strong> (<em>list</em><em> of </em><em>str</em>) – The list of phase names associated with the template event.</p></li>
<li><p><strong>template_filename</strong> (<em>str</em>) – The filename of the template waveform file.</p></li>
<li><p><strong>template_path</strong> (<em>str</em>) – The path to the directory containing the template waveform file.</p></li>
<li><p><strong>latitude</strong> (<em>float</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – The latitude of the template event in decimal degrees. If None, latitude
information is not provided. Defaults to None.</p></li>
<li><p><strong>longitude</strong> (<em>float</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – The longitude of the template event in decimal degrees. If None, longitude
information is not provided. Defaults to None.</p></li>
<li><p><strong>depth</strong> (<em>float</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – The depth of the template event in kilometers. If None, depth information
is not provided. Defaults to None.</p></li>
<li><p><strong>sampling_rate</strong> (<em>float</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – The sampling rate of the template waveforms in Hz. If None, the sampling
rate is not provided. Defaults to None.</p></li>
<li><p><strong>components</strong> (<em>list</em><em> of </em><em>str</em><em>, </em><em>optional</em>) – The list of component names associated with the template waveforms.
Defaults to [‘N’, ‘E’, ‘Z’].</p></li>
<li><p><strong>id</strong> (<em>str</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – The ID of the template event. If None, no ID is assigned. Defaults to None.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Template.distance">
<span class="sig-name descname"><span class="pre">distance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">longitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#Template.distance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.Template.distance" title="Link to this definition"></a></dt>
<dd><p>Compute the distance between the template and a given location.</p>
<p>This function calculates the distance between the longitude, latitude, and depth
of the template and the longitude, latitude, and depth of a target location using
the <cite>two_point_distance</cite> function from the <cite>utils</cite> module.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>longitude</strong> (<em>float</em>) – The longitude of the target location.</p></li>
<li><p><strong>latitude</strong> (<em>float</em>) – The latitude of the target location.</p></li>
<li><p><strong>depth</strong> (<em>float</em>) – The depth of the target location in kilometers.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>distance</strong> – The distance, in kilometers, between the template and the target location.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Template.find_monochromatic_traces">
<span class="sig-name descname"><span class="pre">find_monochromatic_traces</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">autocorr_peak_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.33</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_peaks_criterion</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">taper_pct</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_lag_samp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zeropad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#Template.find_monochromatic_traces"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.Template.find_monochromatic_traces" title="Link to this definition"></a></dt>
<dd><p>Detect traces in seismic waveforms with dominant monochromatic signals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>autocorr_peak_threshold</strong> (<em>float</em><em>, </em><em>optional</em>) – Threshold for peak detection in the autocorrelation function.
Default is 0.33.</p></li>
<li><p><strong>num_peaks_criterion</strong> (<em>int</em><em>, </em><em>optional</em>) – Minimum number of peaks required above the threshold for a trace
to be considered monochromatic. Default is 5.</p></li>
<li><p><strong>taper_pct</strong> (<em>float</em><em>, </em><em>optional</em>) – Percentage of the signal to taper at both ends using a Tukey
window function. Default is 5.0.</p></li>
<li><p><strong>max_lag_samp</strong> (<em>int</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Maximum lag samples to consider in the autocorrelation function.
If None, uses the entire autocorrelation. Default is None.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, displays a warning about the experimental nature of
the method. Default is True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>monochromatic</strong> (<em>pandas.DataFrame</em>) – A DataFrame indicating whether each trace is monochromatic or not.
Rows represent stations and columns represent components.</p></li>
<li><p><strong>num_peaks_above_threshold</strong> (<em>pandas.DataFrame</em>) – A DataFrame containing the number of peaks above the threshold
for each trace.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Template.init_from_event">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">init_from_event</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">event</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attach_waveforms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#Template.init_from_event"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.Template.init_from_event" title="Link to this definition"></a></dt>
<dd><p>Instantiate a Template object from an Event object.</p>
<p>This class method creates a Template object based on an existing Event object.
It converts the Event object into a Template object by transferring the relevant
attributes and data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>event</strong> (<em>Event instance</em>) – The Event instance to convert to a Template instance.</p></li>
<li><p><strong>attach_waveforms</strong> (<em>boolean</em><em>, </em><em>optional</em>) – Specifies whether to attach the waveform data to the Template instance.
If True, the waveform data is attached. If False, the waveform data is not
attached. Defaults to True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>template</strong> – The Template instance based on the provided Event instance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Template instance</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.Template.moveouts_arr">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">moveouts_arr</span></span><a class="headerlink" href="#BPMF.dataset.Template.moveouts_arr" title="Link to this definition"></a></dt>
<dd><p>Return a moveout array given self.components and phase_on_comp.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.Template.moveouts_win">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">moveouts_win</span></span><a class="headerlink" href="#BPMF.dataset.Template.moveouts_win" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Template.plot_detection">
<span class="sig-name descname"><span class="pre">plot_detection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx_or_gid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">db_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">duration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">60.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase_on_comp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'1':</span> <span class="pre">'S',</span> <span class="pre">'2':</span> <span class="pre">'S',</span> <span class="pre">'E':</span> <span class="pre">'S',</span> <span class="pre">'N':</span> <span class="pre">'S',</span> <span class="pre">'Z':</span> <span class="pre">'P'}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset_ot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10.0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#Template.plot_detection"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.Template.plot_detection" title="Link to this definition"></a></dt>
<dd><p>Plot the <cite>idx</cite>-th detection made with this template.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>idx</strong> (<em>int</em>) – Index of the detection to plot.</p></li>
<li><p><strong>filename</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of the detection file. If None, use the standard file and folder naming
convention. Defaults to None.</p></li>
<li><p><strong>db_path</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of the directory where the detection file is located. If None, use the
standard file and folder naming convention. Defaults to None.</p></li>
<li><p><strong>duration</strong> (<em>float</em><em>, </em><em>optional</em>) – Duration of the waveforms to plot, in seconds. Defaults to 60.0.</p></li>
<li><p><strong>phase_on_comp</strong> (<em>dict</em><em>, </em><em>optional</em>) – Dictionary specifying the phase associated with each component. The keys
are component codes, and the values are phase codes. Defaults to
{“N”: “S”, “1”: “S”, “E”: “S”, “2”: “S”, “Z”: “P”}.</p></li>
<li><p><strong>offset_ot</strong> (<em>float</em><em>, </em><em>optional</em>) – Offset in seconds to apply to the origin time of the event when retrieving
the waveforms. Defaults to 10.0.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments to be passed to the <cite>Event.plot</cite> method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fig</strong> – Figure instance produced by this method.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>matplotlib.figure.Figure</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Template.plot_recurrence_times">
<span class="sig-name descname"><span class="pre">plot_recurrence_times</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">annotate_axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unique</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(20,</span> <span class="pre">10)</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#Template.plot_recurrence_times"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.Template.plot_recurrence_times" title="Link to this definition"></a></dt>
<dd><p>Plot recurrence times vs detection times.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> (<em>plt.Axes</em><em>, </em><em>optional</em>) – If not None, use this plt.Axes instance to plot the data.</p></li>
<li><p><strong>annotate_axes</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to annotate the axes with labels. Defaults to True.</p></li>
<li><p><strong>figsize</strong> (<em>tuple</em><em>, </em><em>optional</em>) – Figure size (width, height) in inches. Defaults to (20, 10).</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments to be passed to the plt.plot function.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fig</strong> – Figure instance produced by this method.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>matplotlib.figure.Figure</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Template.read_catalog">
<span class="sig-name descname"><span class="pre">read_catalog</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">db_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_attributes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">nan</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_events</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_summary_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_return_times</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_threads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#Template.read_catalog"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.Template.read_catalog" title="Link to this definition"></a></dt>
<dd><p>Build a Catalog instance from detection data.</p>
<p>This function builds a Catalog instance by reading detection data from a file
specified by <cite>filename</cite> and <cite>db_path</cite>, or by checking for an existing summary
file. It supports reading additional attributes specified by <cite>extra_attributes</cite>
and provides options to control the behavior of filling missing values with
<cite>fill_value</cite> and returning a list of Event instances with <cite>return_events</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of the detection file. If None, the standard file and folder naming
convention will be used. Defaults to None.</p></li>
<li><p><strong>db_path</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of the directory where the detection file is located. If None, the
standard file and folder naming convention will be used. Defaults to None.</p></li>
<li><p><strong>gid</strong> (<em>str</em><em>, </em><em>int</em><em>, or </em><em>float</em><em>, </em><em>optional</em>) – If not None, this is the HDF5 group where the data will be read from.
Defaults to None.</p></li>
<li><p><strong>extra_attributes</strong> (<em>list</em><em> of </em><em>str</em><em>, </em><em>optional</em>) – Additional attributes to read in addition to the default attributes
(‘longitude’, ‘latitude’, ‘depth’, and ‘origin_time’). Defaults to an
empty list.</p></li>
<li><p><strong>fill_value</strong> (<em>str</em><em>, </em><em>int</em><em>, or </em><em>float</em><em>, </em><em>optional</em>) – Default value to fill missing target attributes. Defaults to np.nan.</p></li>
<li><p><strong>return_events</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, a list of Event instances will be returned. This can only be
True if check_summary_file is set to False. Defaults to False.</p></li>
<li><p><strong>check_summary_file</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, it checks if the summary HDF5 file already exists and reads from
it using the standard naming convention. If False, it builds the catalog
from the detection output. Defaults to True.</p></li>
<li><p><strong>compute_return_times</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, it computes inter-event times. Because events detected with the
same template are co-located, these inter-event times can be called
return times.</p></li>
<li><p><strong>n_threads</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of threads to use for parallel execution. If set to 1
(default), the detection files will be read sequentially. If set to
a value greater than 1, the detection files will be read in
parallel using <cite>n_threads</cite> threads.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>If <cite>return_events</cite> is set to True, <cite>check_summary_file</cite> must be set to False.</p></li>
<li><p>The <cite>read_catalog</cite> function first checks if the summary file exists.</p></li>
<li><p>The resulting Catalog instance is assigned to <cite>self.catalog</cite>, and additional
attributes such as ‘tid’ and ‘event_id’ are set accordingly.</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Template.read_from_file">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">read_from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">db_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#Template.read_from_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.Template.read_from_file" title="Link to this definition"></a></dt>
<dd><p>Initialize a Template instance from a file.</p>
<p>This class method reads a file and initializes a Template instance based on the
content of the file. It utilizes the Event class method <cite>read_from_file</cite> to
read the file and convert it into an Event instance. The Event instance is then
converted into a Template instance using the <cite>init_from_event</cite> class method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>) – The name of the file to read and initialize the Template instance.</p></li>
<li><p><strong>db_path</strong> (<em>str</em><em>, </em><em>optional</em>) – The path to the directory containing the file. Defaults to cfg.INPUT_PATH.</p></li>
<li><p><strong>gid</strong> (<em>str</em><em>, </em><em>optional</em>) – The name of the hdf5 group where the file is stored. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>template</strong> – The Template instance initialized from the specified file.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Template instance</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Template.read_waveforms">
<span class="sig-name descname"><span class="pre">read_waveforms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">components</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#Template.read_waveforms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.Template.read_waveforms" title="Link to this definition"></a></dt>
<dd><p>Read the waveforms time series.</p>
<p>This function reads the waveforms from the stored data file and initializes
the <cite>self.traces</cite> attribute with the waveform data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stations</strong> (<em>list</em><em> of </em><em>str</em><em>, </em><em>default None</em>) – The list of station names for which to read the waveforms. If None, all
stations in <cite>self.stations</cite> will be read.</p></li>
<li><p><strong>components</strong> (<em>list</em><em> of </em><em>str</em><em>, </em><em>default None</em>) – The list of component names for which to read the waveforms. If None,
all components in <cite>self.components</cite> will be read.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The waveform data is stored in the <cite>self.traces</cite> attribute as an <cite>obspy.Stream</cite>
object.</p></li>
<li><p>The <cite>starttime</cite> of each trace is set based on the origin time of the event
and the moveout values stored in the <cite>moveouts_win</cite> attribute.</p></li>
<li><p>The <cite>set_availability</cite> method is called to update the availability of the
waveforms for the selected stations.</p></li>
</ul>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.Template.template_idx">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">template_idx</span></span><a class="headerlink" href="#BPMF.dataset.Template.template_idx" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.Template.tid">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">tid</span></span><a class="headerlink" href="#BPMF.dataset.Template.tid" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Template.write">
<span class="sig-name descname"><span class="pre">write</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">db_filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">db_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_waveforms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#Template.write"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.Template.write" title="Link to this definition"></a></dt>
<dd><p>Write the Template instance to an HDF5 file.</p>
<p>This function writes the Template instance to an HDF5 file specified by
<cite>db_filename</cite> and <cite>db_path</cite>. It uses the <cite>Event.write</cite> method to handle the
majority of the writing process.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>db_filename</strong> (<em>str</em>) – Name of the HDF5 file to store the Template instance.</p></li>
<li><p><strong>db_path</strong> (<em>str</em><em>, </em><em>optional</em>) – Path to the directory where the HDF5 file will be located. Defaults to
<cite>cfg.OUTPUT_PATH</cite>.</p></li>
<li><p><strong>save_waveforms</strong> (<em>bool</em><em>, </em><em>optional</em>) – Flag indicating whether to save the waveforms in the HDF5 file. Defaults
to True.</p></li>
<li><p><strong>gid</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of the HDF5 group under which the Template instance will be stored.
If None, the Template instance will be stored directly in the root of
the HDF5 file. Defaults to None.</p></li>
<li><p><strong>overwrite</strong> (<em>bool</em><em>, </em><em>optional</em>) – Flag indicating whether to overwrite an existing HDF5 file with the same
name. If True, the existing file will be removed before writing. If False,
the write operation will be skipped. Defaults to False.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The <cite>write</cite> function sets the <cite>where</cite> attribute of the Template instance
to the full path of the HDF5 file.</p></li>
<li><p>If <cite>overwrite</cite> is True and an existing file with the same name already
exists, it will be removed before writing the Template instance.</p></li>
<li><p>The majority of the writing process is handled by the <cite>Event.write</cite> method,
which is called with appropriate arguments.</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Template.write_summary">
<span class="sig-name descname"><span class="pre">write_summary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">attributes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">db_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#Template.write_summary"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.Template.write_summary" title="Link to this definition"></a></dt>
<dd><p>Write the summary of template characteristics to an HDF5 file.</p>
<p>This function writes the summary of template characteristics, e.g. the
characteristics of the detected events, specified in the <cite>attributes</cite>
dictionary to an HDF5 file specified by <cite>filename</cite> and <cite>db_path</cite>.
It supports overwriting existing datasets or groups with <cite>overwrite</cite> option.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>attributes</strong> (<em>dict</em>) – Dictionary containing scalars, numpy arrays, dictionaries, or pandas dataframes.
The keys of the dictionary are used to name the dataset or group in the HDF5 file.</p></li>
<li><p><strong>filename</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of the detection file. If None, the standard file and folder naming
convention will be used. Defaults to None.</p></li>
<li><p><strong>db_path</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of the directory where the detection file is located. If None, the
standard file and folder naming convention will be used. Defaults to None.</p></li>
<li><p><strong>overwrite</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, existing datasets or groups will be overwritten. If False, they
will be skipped. Defaults to True.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="BPMF.dataset.TemplateGroup">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">BPMF.dataset.</span></span><span class="sig-name descname"><span class="pre">TemplateGroup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">templates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">network</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_receiver_dist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#TemplateGroup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.TemplateGroup" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#BPMF.dataset.Family" title="BPMF.dataset.Family"><code class="xref py py-class docutils literal notranslate"><span class="pre">Family</span></code></a></p>
<p>A class for a group of templates.</p>
<p>Each template is represented by a <cite>dataset.Template</cite> instance.</p>
<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.TemplateGroup.box">
<span class="sig-name descname"><span class="pre">box</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lon_min</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat_min</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#TemplateGroup.box"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.TemplateGroup.box" title="Link to this definition"></a></dt>
<dd><p>Keep templates inside the requested geographic bounds.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lon_min</strong> (<em>float</em>) – Minimum longitude in decimal degrees.</p></li>
<li><p><strong>lon_max</strong> (<em>float</em>) – Maximum longitude in decimal degrees.</p></li>
<li><p><strong>lat_min</strong> (<em>float</em>) – Minimum latitude in decimal degrees.</p></li>
<li><p><strong>lat_max</strong> (<em>float</em>) – Maximum latitude in decimal degrees.</p></li>
<li><p><strong>inplace</strong> (<em>bool</em><em>, </em><em>default False</em>) – If True, perform the operation in-place by modifying the existing TemplateGroup.
If False, create and return a new TemplateGroup with the filtered templates.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>template_group</strong> – The TemplateGroup instance containing templates within the specified geographic bounds.
This is returned only when inplace=False.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>TemplateGroup instance</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.TemplateGroup.compute_dir_errors">
<span class="sig-name descname"><span class="pre">compute_dir_errors</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#TemplateGroup.compute_dir_errors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.TemplateGroup.compute_dir_errors" title="Link to this definition"></a></dt>
<dd><p>Compute the length of the uncertainty ellipsoid in the inter-template direction.</p>
<p>This method calculates the length of the uncertainty ellipsoid in the
inter-template direction for each pair of templates in the TemplateGroup.
The inter-template direction is defined as the direction linking two templates.
The length of the uncertainty ellipsoid is computed based on the covariance
matrix of each template.</p>
<p>The computed errors can be read at the <cite>self.dir_errors</cite> property of
the TemplateGroup. It is a pandas DataFrame with dimensions
(n_templates, n_templates), where each entry represents the length of
the uncertainty ellipsoid in kilometers.</p>
<p>Example: <cite>self.dir_errors.loc[tid1, tid2]</cite> is the width of template <cite>tid1</cite>’s
uncertainty ellipsoid in the direction of template <cite>tid2</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The computed errors can be read at the <cite>self.dir_errors</cite> property
of the TemplateGroup instance.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.TemplateGroup.compute_ellipsoid_dist">
<span class="sig-name descname"><span class="pre">compute_ellipsoid_dist</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#TemplateGroup.compute_ellipsoid_dist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.TemplateGroup.compute_ellipsoid_dist" title="Link to this definition"></a></dt>
<dd><p>Compute the separation between uncertainty ellipsoids in the inter-template direction.</p>
<p>This method calculates the separation between the uncertainty
ellipsoids in the inter-template direction for each pair of templates
in the TemplateGroup instance. The separation is computed as the difference
between the inter-template distances and the directional errors. It can
be negative if the uncertainty ellipsoids overlap.</p>
<p>The computed separations can be read at the <cite>self.ellipsoid_dist</cite>
property of the TemplateGroup instance. It is a pandas DataFrame with
dimensions (n_templates, n_templates), where each entry represents
the separation between the uncertainty ellipsoids in kilometers.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The computed separations can be read at the <cite>self.ellipsoid_dist</cite>
property of the TemplateGroup instance.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.TemplateGroup.compute_intertemplate_cc">
<span class="sig-name descname"><span class="pre">compute_intertemplate_cc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">distance_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_stations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_lag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_cc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_from_scratch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cpu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'intertp_cc.h5'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#TemplateGroup.compute_intertemplate_cc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.TemplateGroup.compute_intertemplate_cc" title="Link to this definition"></a></dt>
<dd><p>Compute the pairwise template cross-correlations (CCs).</p>
<p>This method computes the pairwise cross-correlations (CCs) between
templates in the TemplateGroup.</p>
<p>The CCs measure the similarity between the waveforms of different templates.
CCs are computed only for template pairs that are separated by less than
<cite>distance_threhold</cite>. The number of closest stations to include and the maximum
lag for searching the maximum CC are configurable parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>distance_threshold</strong> (<em>float</em><em>, </em><em>default to 5.0</em>) – The distance threshold, in kilometers, between two uncertainty
ellipsoids under which the CC is computed.</p></li>
<li><p><strong>n_stations</strong> (<em>int</em><em>, </em><em>default to 10</em>) – The number of closest stations to each template that are used in
the computation of the average CC.</p></li>
<li><p><strong>max_lag</strong> (<em>int</em><em>, </em><em>default to 10</em>) – The maximum lag, in samples, allowed when searching for the maximum
CC on each channel. This parameter accounts for small discrepancies
in windowing that could occur for two templates highly similar but
associated with slightly different locations.</p></li>
<li><p><strong>save_cc</strong> (<em>bool</em><em>, </em><em>default to False</em>) – If True, save the inter-template CCs in the same folder as the first
template (<cite>self.templates[0]</cite>) with filename ‘output_filename’.</p></li>
<li><p><strong>compute_from_scratch</strong> (<em>bool</em><em>, </em><em>default to False</em>) – If True, force the computation of the inter-template CCs from scratch.
This is useful when the user knows that the computation is faster than
reading a potentially large file.</p></li>
<li><p><strong>device</strong> (<em>str</em><em>, </em><em>default to 'cpu'</em>) – The device to use for the computation. Can be either ‘cpu’ or ‘gpu’.</p></li>
<li><p><strong>progress</strong> (<em>bool</em><em>, </em><em>default to False</em>) – If True, print a progress bar using <cite>tqdm</cite>.</p></li>
<li><p><strong>output_filename</strong> (<em>str</em><em>, </em><em>default to 'intertp_cc.h5'</em>) – The filename to use when saving the inter-template CCs.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The computed inter-template CCs can be read at the <cite>self.intertemplate_cc</cite>
property of the TemplateGroup instance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.TemplateGroup.compute_intertemplate_dist">
<span class="sig-name descname"><span class="pre">compute_intertemplate_dist</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#TemplateGroup.compute_intertemplate_dist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.TemplateGroup.compute_intertemplate_dist" title="Link to this definition"></a></dt>
<dd><p>Compute the template-pairwise distances in kilometers.</p>
<p>This method calculates the distances between all pairs of templates in the TemplateGroup.
The distances are computed based on the longitude, latitude, and depth of each template.</p>
<p>The computed distances are then read at the <cite>self.intertemplate_dist</cite> property
of the TemplateGroup instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The computed distances can be accessed at the <cite>self.intertemplate_dist</cite>
property of the TemplateGroup.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.TemplateGroup.dir_errors">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dir_errors</span></span><a class="headerlink" href="#BPMF.dataset.TemplateGroup.dir_errors" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.TemplateGroup.ellipsoid_dist">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ellipsoid_dist</span></span><a class="headerlink" href="#BPMF.dataset.TemplateGroup.ellipsoid_dist" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.TemplateGroup.intertemplate_cc">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">intertemplate_cc</span></span><a class="headerlink" href="#BPMF.dataset.TemplateGroup.intertemplate_cc" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.TemplateGroup.intertemplate_dist">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">intertemplate_dist</span></span><a class="headerlink" href="#BPMF.dataset.TemplateGroup.intertemplate_dist" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.TemplateGroup.n_best_SNR_stations">
<span class="sig-name descname"><span class="pre">n_best_SNR_stations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">available_stations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#TemplateGroup.n_best_SNR_stations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.TemplateGroup.n_best_SNR_stations" title="Link to this definition"></a></dt>
<dd><p>Adjust <cite>self.stations</cite> on each template to the <cite>n</cite> best SNR stations.</p>
<p>This method calls <cite>template.n_best_SNR_stations</cite> for each Template
instance in <cite>self.templates</cite>. For each template, it finds the <cite>n</cite> best
SNR stations and modify <cite>template.stations</cite> accordingly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<em>int</em>) – The <cite>n</cite> best SNR stations.</p></li>
<li><p><strong>available_stations</strong> (<em>list</em><em> of </em><em>str</em><em>, </em><em>optional</em>) – The list of stations from which we search the closest stations.
If some stations are known to lack data, the user
may choose to not include these in the best SNR stations.
Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.TemplateGroup.n_closest_stations">
<span class="sig-name descname"><span class="pre">n_closest_stations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">available_stations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#TemplateGroup.n_closest_stations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.TemplateGroup.n_closest_stations" title="Link to this definition"></a></dt>
<dd><p>Adjust <cite>self.stations</cite> on each template to the <cite>n</cite> closest stations.</p>
<p>This method calls <cite>template.n_closest_stations</cite> for each Template
instance in <cite>self.templates</cite>. For each template, it finds the <cite>n</cite>
closest stations and modify <cite>template.stations</cite> accordingly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<em>int</em>) – The <cite>n</cite> closest stations.</p></li>
<li><p><strong>available_stations</strong> (<em>list</em><em> of </em><em>str</em><em>, </em><em>optional</em>) – The list of stations from which we search the closest stations.
If some stations are known to lack data, the user
may choose to not include these in the closest stations.
Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.TemplateGroup.n_templates">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_templates</span></span><a class="headerlink" href="#BPMF.dataset.TemplateGroup.n_templates" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.TemplateGroup.network_to_template_map">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">network_to_template_map</span></span><a class="headerlink" href="#BPMF.dataset.TemplateGroup.network_to_template_map" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.TemplateGroup.plot_detection">
<span class="sig-name descname"><span class="pre">plot_detection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">row_idx</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#TemplateGroup.plot_detection"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.TemplateGroup.plot_detection" title="Link to this definition"></a></dt>
<dd><p>Plot the <cite>row_idx</cite> event in <cite>self.catalog.catalog</cite>.</p>
<p>This method identifies which template detected the <cite>row_idx</cite> event
and calls <cite>template.plot_detection</cite> with the appropriate arguments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>row_idx</strong> (<em>self.catalog.catalog.index.dtype</em>) – Row index of event in <cite>self.catalog.catalog</cite>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fig</strong> – The figure showing the detected event.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>matplotlib.pyplot.Figure</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.TemplateGroup.plot_recurrence_times">
<span class="sig-name descname"><span class="pre">plot_recurrence_times</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(15,</span> <span class="pre">7)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#TemplateGroup.plot_recurrence_times"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.TemplateGroup.plot_recurrence_times" title="Link to this definition"></a></dt>
<dd><p>Plot recurrence times vs detection times, template-wise.</p>
<p>This method calls <cite>template.plot_recurrence_times</cite> for every
Template instance in <cite>self.templates</cite>. Thus, the recurrence time
is defined template-wise.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>figsize</strong> (<em>tuple</em><em> of </em><em>floats</em><em>, </em><em>optional</em>) – Size in inches of the figure (width, height).
Defaults to (15, 7).</p></li>
<li><p><strong>progress</strong> (<em>boolean</em><em>, </em><em>optional</em>) – If True, print progress bar with <cite>tqdm</cite>. Defaults to False.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.TemplateGroup.read_catalog">
<span class="sig-name descname"><span class="pre">read_catalog</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">extra_attributes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">nan</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_threads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#TemplateGroup.read_catalog"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.TemplateGroup.read_catalog" title="Link to this definition"></a></dt>
<dd><p>Build a catalog from all templates’ detections.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>extra_attributes</strong> (<em>list</em><em> of </em><em>str</em><em>, </em><em>optional</em>) – Additional attributes to read in addition to the default attributes of
‘longitude’, ‘latitude’, ‘depth’, and ‘origin_time’.</p></li>
<li><p><strong>fill_value</strong> (<em>str</em><em>, </em><em>int</em><em>, or </em><em>float</em><em>, </em><em>optional</em>) – Default value to use if the target attribute does not exist in a template’s
detections.</p></li>
<li><p><strong>progress</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, display a progress bar during the operation.</p></li>
<li><p><strong>n_threads</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of threads to use for parallel execution. If set to 1
(default), the detection files will be read sequentially. If set to
a value greater than 1, the detection files will be read in
parallel using <cite>n_threads</cite> threads.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments to be passed to the <cite>read_catalog</cite>
method of each template.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method reads the detection information from each template in the TemplateGroup
and builds a catalog that contains the combined detections from all templates.</p>
<p>The resulting catalog will include the default attributes of ‘longitude’, ‘latitude’,
‘depth’, and ‘origin_time’, as well as any additional attributes specified in
the <cite>extra_attributes</cite> parameter.</p>
<p>If a template does not have a specific attribute in its detections, it will be assigned
the <cite>fill_value</cite> for that attribute.</p>
<p>The <cite>progress</cite> parameter controls whether a progress bar is displayed during the operation.
Setting it to True provides visual feedback on the progress of reading the catalogs.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.TemplateGroup.read_from_files">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">read_from_files</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filenames</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">network</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#TemplateGroup.read_from_files"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.TemplateGroup.read_from_files" title="Link to this definition"></a></dt>
<dd><p>Initialize the TemplateGroup instance given a list of filenames.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filenames</strong> (<em>list</em><em> of </em><em>str</em>) – List of full file paths from which to instantiate the list
of <cite>dataset.Template</cite> objects.</p></li>
<li><p><strong>network</strong> (<cite>dataset.Network</cite> instance) – The <cite>Network</cite> instance used to query consistent data across all templates.</p></li>
<li><p><strong>gids</strong> (<em>list</em><em> of </em><em>str</em><em>, </em><em>optional</em>) – If provided, this should be a list of group IDs where the
template data is stored in their HDF5 files.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>template_group</strong> – The initialized TemplateGroup instance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>TemplateGroup instance</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.TemplateGroup.read_waveforms">
<span class="sig-name descname"><span class="pre">read_waveforms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_threads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#TemplateGroup.read_waveforms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.TemplateGroup.read_waveforms" title="Link to this definition"></a></dt>
<dd><p>Read waveforms for all templates in the TemplateGroup.</p>
<p>This method calls <cite>template.read_waveforms</cite> for each <cite>Template</cite>
instance in <cite>self.templates</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_threads</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of threads to use for parallel execution. If set to 1
(default), the waveforms will be read sequentially. If set to a
value greater than 1, the waveforms will be read in parallel using
multiple threads. If set to 0, None, or “all”, the method will use all
available CPUs for parallel execution.</p></li>
<li><p><strong>progress</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, a progress bar will be displayed during the waveform reading process.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.TemplateGroup.remove_multiples">
<span class="sig-name descname"><span class="pre">remove_multiples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_closest_stations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt_criterion</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distance_criterion</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">speed_criterion</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">similarity_criterion</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_lag_for_sim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#TemplateGroup.remove_multiples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.TemplateGroup.remove_multiples" title="Link to this definition"></a></dt>
<dd><p>Search for events detected by multiple templates and flag them.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_closest_stations</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of stations closest to each template used in the calculation
of the average cross-correlation (cc).</p></li>
<li><p><strong>dt_criterion</strong> (<em>float</em><em>, </em><em>optional</em>) – The time interval, in seconds, under which two events are examined for redundancy.</p></li>
<li><p><strong>distance_criterion</strong> (<em>float</em><em>, </em><em>optional</em>) – The distance threshold, in kilometers, between two uncertainty ellipsoids
under which two events are examined for redundancy.</p></li>
<li><p><strong>speed_criterion</strong> (<em>float</em><em>, </em><em>optional</em>) – The speed criterion, in km/s, below which the inter-event time and inter-event
distance can be explained by errors in origin times and a reasonable P-wave speed.</p></li>
<li><p><strong>similarity_criterion</strong> (<em>float</em><em>, </em><em>optional</em>) – The template similarity threshold, in terms of average cc, over which two events
are examined for redundancy. The default value of -1 means that similarity is not
taken into account.</p></li>
<li><p><strong>progress</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, print progress bar with <cite>tqdm</cite>.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method creates a new entry in each Template instance’s catalog where
unique events are flagged:
<cite>self.templates[i].catalog.catalog[‘unique_events’]</cite></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.TemplateGroup.set_network_to_template_map">
<span class="sig-name descname"><span class="pre">set_network_to_template_map</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/BPMF/dataset.html#TemplateGroup.set_network_to_template_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#BPMF.dataset.TemplateGroup.set_network_to_template_map" title="Link to this definition"></a></dt>
<dd><p>Compute the map between network arrays and template data.</p>
<p>Template data are broadcasted to fit the dimensions of the network
arrays. This method computes the <cite>network_to_template_map</cite> that tells
which stations and channels are used on each template.
For example:
<cite>network_to_template_map[t, s, c] = False</cite>
means that station s and channel c are not used on template t.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>None</strong></p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="clib.html" class="btn btn-neutral float-left" title="BPMF.clib" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="data_reader_examples.html" class="btn btn-neutral float-right" title="BPMF.data_reader_examples" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Eric Beauce, William B. Frank.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>