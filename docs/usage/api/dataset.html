
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>BPMF.dataset &#8212; BPMF 2.0.0 documentation</title>
    <link rel="stylesheet" href="../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/insipid.css" />

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script defer src="../../_static/insipid.js"></script>
    <script defer src="../../_static/insipid-sidebar.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="BPMF.template_search" href="template_search.html" />
    <link rel="prev" title="API" href="../api.html" />
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
  </head><body>
    <script type="text/javascript">
        document.body.classList.add('js');
    </script>
    <input type="checkbox" id="sidebar-checkbox" style="display: none;">
    <label id="overlay" for="sidebar-checkbox"></label>
    <div class="sidebar-resize-handle"></div>
    <script type="text/javascript">
        try {
            let sidebar = localStorage.getItem('sphinx-sidebar');
            const sidebar_width = localStorage.getItem('sphinx-sidebar-width');
            if (sidebar_width) {
                document.documentElement.style.setProperty('--sidebar-width', sidebar_width);
            }
            // show sidebar on wide screen
            if (!sidebar && window.matchMedia('(min-width: 100rem)').matches) {
                sidebar = 'visible';
                // NB: We don't store the value in localStorage!
            }
            if (sidebar === 'visible') {
                document.getElementById('sidebar-checkbox').checked = true;
            }
        } catch(e) {
            console.info(e);
        }
    </script>
    <header id="topbar-placeholder">
      <div id="topbar">
        <div id="titlebar">
          <div class="buttons">
            <label for="sidebar-checkbox" id="sidebar-button" role="button" tabindex="0" aria-controls="sphinxsidebar" accesskey="M">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M16 132h416c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163 0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z"/></svg>
            </label>
            <button id="search-button" type="button" title="Search" aria-label="Search" aria-expanded="false" aria-controls="search-form" accesskey="S">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
            </button>
          </div>
          <div class="title">
            <a class="parent" href="../api.html" accesskey="U">API</a>
            <a class="top" href="#">BPMF.dataset</a>
          </div>
          <div class="buttons">
            <button id="fullscreen-button" type="button" aria-hidden="true">
              <span class="enable">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M212.686 315.314L120 408l32.922 31.029c15.12 15.12 4.412 40.971-16.97 40.971h-112C10.697 480 0 469.255 0 456V344c0-21.382 25.803-32.09 40.922-16.971L72 360l92.686-92.686c6.248-6.248 16.379-6.248 22.627 0l25.373 25.373c6.249 6.248 6.249 16.378 0 22.627zm22.628-118.628L328 104l-32.922-31.029C279.958 57.851 290.666 32 312.048 32h112C437.303 32 448 42.745 448 56v112c0 21.382-25.803 32.09-40.922 16.971L376 152l-92.686 92.686c-6.248 6.248-16.379 6.248-22.627 0l-25.373-25.373c-6.249-6.248-6.249-16.378 0-22.627z"/></svg>
              </span>
              <span class="disable">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M4.686 427.314L104 328l-32.922-31.029C55.958 281.851 66.666 256 88.048 256h112C213.303 256 224 266.745 224 280v112c0 21.382-25.803 32.09-40.922 16.971L152 376l-99.314 99.314c-6.248 6.248-16.379 6.248-22.627 0L4.686 449.941c-6.248-6.248-6.248-16.379 0-22.627zM443.314 84.686L344 184l32.922 31.029c15.12 15.12 4.412 40.971-16.97 40.971h-112C234.697 256 224 245.255 224 232V120c0-21.382 25.803-32.09 40.922-16.971L296 136l99.314-99.314c6.248-6.248 16.379-6.248 22.627 0l25.373 25.373c6.248 6.248 6.248 16.379 0 22.627z"/></svg>
              </span>
            </button>
          </div>
        </div>
        <div id="searchbox" role="search">
          <form id="search-form" class="search" style="display: none" action="../../search.html" method="get">
            <input type="search" name="q" placeholder="Search ..." autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" />
            <button>Go</button>
          </form>
        </div>
      </div>
    </header>
    <nav>
      <a href="../api.html" class="nav-icon previous" title="previous:&#13;API" aria-label="Previous topic" accesskey="P" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M31.7 239l136-136c9.4-9.4 24.6-9.4 33.9 0l22.6 22.6c9.4 9.4 9.4 24.6 0 33.9L127.9 256l96.4 96.4c9.4 9.4 9.4 24.6 0 33.9L201.7 409c-9.4 9.4-24.6 9.4-33.9 0l-136-136c-9.5-9.4-9.5-24.6-.1-34z"/></svg>
      </a>
      <a href="template_search.html" class="nav-icon next" title="next:&#13;BPMF.template_search" aria-label="Next topic" accesskey="N" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M224.3 273l-136 136c-9.4 9.4-24.6 9.4-33.9 0l-22.6-22.6c-9.4-9.4-9.4-24.6 0-33.9l96.4-96.4-96.4-96.4c-9.4-9.4-9.4-24.6 0-33.9L54.3 103c9.4-9.4 24.6-9.4 33.9 0l136 136c9.5 9.4 9.5 24.6.1 34z"/></svg>
      </a>
    </nav>

    <nav class="relbar">
      <a class="previous" href="../api.html" aria-label="Previous topic" >
        <div class="icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M257.5 445.1l-22.2 22.2c-9.4 9.4-24.6 9.4-33.9 0L7 273c-9.4-9.4-9.4-24.6 0-33.9L201.4 44.7c9.4-9.4 24.6-9.4 33.9 0l22.2 22.2c9.5 9.5 9.3 25-.4 34.3L136.6 216H424c13.3 0 24 10.7 24 24v32c0 13.3-10.7 24-24 24H136.6l120.5 114.8c9.8 9.3 10 24.8.4 34.3z"/></svg>
        </div>
        <div class="title">
          <span class="text">
            <span class="direction">previous</span>
            API
          </span>
        </div>
      </a>
      <a class="next" href="template_search.html" aria-label="Next topic" >
        <div class="title">
          <span class="text">
            <span class="direction">next</span>
            BPMF.template_search
          </span>
        </div>
        <div class="icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M190.5 66.9l22.2-22.2c9.4-9.4 24.6-9.4 33.9 0L441 239c9.4 9.4 9.4 24.6 0 33.9L246.6 467.3c-9.4 9.4-24.6 9.4-33.9 0l-22.2-22.2c-9.5-9.5-9.3-25 .4-34.3L311.4 296H24c-13.3 0-24-10.7-24-24v-32c0-13.3 10.7-24 24-24h287.4L190.9 101.2c-9.8-9.3-10-24.8-.4-34.3z"/></svg>
        </div>
      </a>
    </nav>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
<section id="module-BPMF.dataset">
<span id="bpmf-dataset"></span><h1>BPMF.dataset<a class="headerlink" href="#module-BPMF.dataset" title="Permalink to this heading">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="BPMF.dataset.Catalog">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">BPMF.dataset.</span></span><span class="sig-name descname"><span class="pre">Catalog</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">longitudes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latitudes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depths</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">origin_times</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">event_ids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BPMF.dataset.Catalog" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class for catalog data, and basic plotting.</p>
<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Catalog.concatenate">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">concatenate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">catalogs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BPMF.dataset.Catalog.concatenate" title="Permalink to this definition">¶</a></dt>
<dd><p>Build catalog from list of <cite>pandas.DataFrame</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>catalogs</strong> (list of <cite>pandas.DataFrame</cite>) – List of <cite>pandas.DataFrame</cite> with consistent columns.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.Catalog.depth">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">depth</span></span><a class="headerlink" href="#BPMF.dataset.Catalog.depth" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.Catalog.latitude">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">latitude</span></span><a class="headerlink" href="#BPMF.dataset.Catalog.latitude" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.Catalog.longitude">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">longitude</span></span><a class="headerlink" href="#BPMF.dataset.Catalog.longitude" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.Catalog.origin_time">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">origin_time</span></span><a class="headerlink" href="#BPMF.dataset.Catalog.origin_time" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Catalog.plot_map">
<span class="sig-name descname"><span class="pre">plot_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(20,</span> <span class="pre">10)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20.0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BPMF.dataset.Catalog.plot_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot epicenters on map.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> (<cite>plt.Axes</cite>, default to None) – If None, create a new <cite>plt.Figure</cite> and <cite>plt.Axes</cite> instances. If
speficied by user, use the provided instance to plot.</p></li>
<li><p><strong>figsize</strong> (<em>tuple of floats</em><em>, </em><em>default to</em><em> (</em><em>20</em><em>, </em><em>10</em><em>)</em>) – Size, in inches, of the figure (width, height).</p></li>
<li><p><strong>depth_min</strong> (<em>scalar float</em><em>, </em><em>default to 0</em>) – Smallest depth, in km, in the depth colormap.</p></li>
<li><p><strong>depth_max</strong> (<em>scalar float</em><em>, </em><em>default to 20</em>) – Largest depth, in km, in the depth colormap.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fig</strong> – The figure with depth color-coded epicenters.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>plt.Figure</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Catalog.plot_space_time">
<span class="sig-name descname"><span class="pre">plot_space_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(20,</span> <span class="pre">10)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_coded</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'longitude'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'latitude'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BPMF.dataset.Catalog.plot_space_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the space-time event distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> (<cite>plt.Axes</cite>, default to None) – If None, create a new <cite>plt.Figure</cite> and <cite>plt.Axes</cite> instances. If
speficied by user, use the provided instance to plot.</p></li>
<li><p><strong>figsize</strong> (<em>tuple of floats</em><em>, </em><em>default to</em><em> (</em><em>20</em><em>, </em><em>10</em><em>)</em>) – Size, in inches, of the figure (width, height).</p></li>
<li><p><strong>color_coded</strong> (<em>string</em><em>, </em><em>default to 'longitude'</em>) – Can be either ‘longitude’, ‘latitude’, or ‘depth’. This is the
attribute used to define the color scale of each dot.</p></li>
<li><p><strong>y_axis</strong> (<em>string</em><em>, </em><em>default to 'latitude'</em>) – Can be either ‘longitude’, ‘latitude’, or ‘depth’. This is the
attribute used to define the y-axis coordinates.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fig</strong> – The figure with color coded latitudes or longitudes.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>plt.Figure</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Catalog.plot_time_statistics">
<span class="sig-name descname"><span class="pre">plot_time_statistics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(16,</span> <span class="pre">7)</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BPMF.dataset.Catalog.plot_time_statistics" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the histograms of time of the day and day of the week.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>figsize</strong> (<em>tuple of floats</em><em>, </em><em>default to</em><em> (</em><em>16</em><em>, </em><em>7</em><em>)</em>) – Size, in inches, of the figure (width, height).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fig</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>plt.Figure</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Catalog.read_from_detection_file">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">read_from_detection_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">db_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_attributes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">nan</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_events</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BPMF.dataset.Catalog.read_from_detection_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Read all detected events and build catalog.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Catalog.read_from_events">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">read_from_events</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">events</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_attributes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">nan</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BPMF.dataset.Catalog.read_from_events" title="Permalink to this definition">¶</a></dt>
<dd><p>Build catalog from list of <cite>Event</cite> instances.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="BPMF.dataset.Data">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">BPMF.dataset.</span></span><span class="sig-name descname"><span class="pre">Data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">where</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_reader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">db_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">duration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">86400.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BPMF.dataset.Data" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A Data class to manipulate waveforms and metadata.</p>
<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Data.get_np_array">
<span class="sig-name descname"><span class="pre">get_np_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stations</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">components</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['N',</span> <span class="pre">'E',</span> <span class="pre">'Z']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">component_aliases</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'E':</span> <span class="pre">['E',</span> <span class="pre">'2'],</span> <span class="pre">'N':</span> <span class="pre">['N',</span> <span class="pre">'1'],</span> <span class="pre">'Z':</span> <span class="pre">['Z']}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">priority</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'HH'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BPMF.dataset.Data.get_np_array" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Data.read_waveforms">
<span class="sig-name descname"><span class="pre">read_waveforms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trim_traces</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">reader_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BPMF.dataset.Data.read_waveforms" title="Permalink to this definition">¶</a></dt>
<dd><p>Read the waveform time series.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>trim_traces</strong> (<em>boolean</em><em>, </em><em>default to True</em>) – If True, call <cite>trim_waveforms</cite> to make sure all traces have the same
start time.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Data.set_availability">
<span class="sig-name descname"><span class="pre">set_availability</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stations</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BPMF.dataset.Data.set_availability" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the data availability.</p>
<p>A station is available if at least one station has non-zero data. The
availability is then accessed via the property <cite>self.availability</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>stations</strong> (<em>list of strings</em><em> or </em><em>numpy.ndarray</em>) – Names of the stations on which we check availability. If None, use
<cite>self.stations</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.Data.sr">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sr</span></span><a class="headerlink" href="#BPMF.dataset.Data.sr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.Data.time">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">time</span></span><a class="headerlink" href="#BPMF.dataset.Data.time" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Data.trim_waveforms">
<span class="sig-name descname"><span class="pre">trim_waveforms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">starttime</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">endtime</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BPMF.dataset.Data.trim_waveforms" title="Permalink to this definition">¶</a></dt>
<dd><p>Trim waveforms.</p>
<p>Start times might differ of one sample on different traces. Use this
method to make sure all traces have the same start time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>starttime</strong> (<em>string</em><em> or </em><em>datetime</em><em>, </em><em>default to None</em>) – If None, use <cite>self.date</cite> as the start time.</p></li>
<li><p><strong>endtime</strong> (<em>string</em><em> or </em><em>datetime</em><em>, </em><em>default to None</em>) – If None, use <cite>self.date</cite> + <cite>self.duration</cite> as the end time.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="BPMF.dataset.Event">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">BPMF.dataset.</span></span><span class="sig-name descname"><span class="pre">Event</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">origin_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">moveouts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stations</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phases</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latitude</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">longitude</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">component_aliases</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'E':</span> <span class="pre">['E',</span> <span class="pre">'2'],</span> <span class="pre">'N':</span> <span class="pre">['N',</span> <span class="pre">'1'],</span> <span class="pre">'Z':</span> <span class="pre">['Z']}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">components</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['N',</span> <span class="pre">'E',</span> <span class="pre">'Z']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_reader</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BPMF.dataset.Event" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>An Event class to describe <em>any</em> collection of waveforms.</p>
<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.Event.availability">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">availability</span></span><a class="headerlink" href="#BPMF.dataset.Event.availability" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.Event.az_hmax_unc">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">az_hmax_unc</span></span><a class="headerlink" href="#BPMF.dataset.Event.az_hmax_unc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.Event.az_hmin_unc">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">az_hmin_unc</span></span><a class="headerlink" href="#BPMF.dataset.Event.az_hmin_unc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Event.get_np_array">
<span class="sig-name descname"><span class="pre">get_np_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stations</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">components</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">priority</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'HH'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BPMF.dataset.Event.get_np_array" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.Event.hmax_unc">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">hmax_unc</span></span><a class="headerlink" href="#BPMF.dataset.Event.hmax_unc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.Event.hmin_unc">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">hmin_unc</span></span><a class="headerlink" href="#BPMF.dataset.Event.hmin_unc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Event.hor_ver_uncertainties">
<span class="sig-name descname"><span class="pre">hor_ver_uncertainties</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'intersection'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BPMF.dataset.Event.hor_ver_uncertainties" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the horizontal and vertical uncertainties on location.</p>
<p>Return errors as given by the 68% confidence ellipsoid.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mode</strong> (<em>string</em><em>, </em><em>default to 'intersection'</em>) – Either ‘intersection’ or ‘projection’. If <cite>mode</cite> is ‘intersection’, the
horizontal uncertainties are the lengths of the semi-axes of the ellipse
defined by the intersection between the confidence ellipsoid and the
horizontal plane. This is consistent with the horizontal errors returned
by NLLoc. If mode is ‘projection’, the horizontal uncertainties are the
max and min span of the confidence ellipsoid in the horizontal
directions.</p></li>
<li><p><strong>Attributes</strong> (<em>New</em>) – </p></li>
<li><p><strong>----------------</strong> – </p></li>
<li><p><strong>hmax_unc</strong> (<em>scalar</em><em>, </em><em>float</em>) – The maximum horizontal uncertainty, in km.</p></li>
<li><p><strong>hmin_unc</strong> (<em>scalar</em><em>, </em><em>float</em>) – The minimum horizontal uncertainty, in km.</p></li>
<li><p><strong>vmax_unc</strong> (<em>scalar</em><em>, </em><em>float</em>) – The maximum vertical uncertainty, in km.</p></li>
<li><p><strong>az_hmax_unc</strong> (<em>scalar</em><em>, </em><em>float</em>) – The azimuth (angle from north) of the maximum horizontal
uncertainty, in degrees.</p></li>
<li><p><strong>az_hmin_unc</strong> (<em>scalar</em><em>, </em><em>float</em>) – The azimuth (angle from north) of the minimum horizontal
uncertainty, in degrees.</p></li>
<li><p><strong>Note</strong> (<em>hmax + vmax does not have to be equal to the</em>) – </p></li>
<li><p><strong>max_loc</strong> – </p></li>
<li><p><strong>the</strong> (<em>the latter simply being the length of</em>) – </p></li>
<li><p><strong>ellipsoid.</strong> (<em>longest semi-axis of the uncertainty</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Event.n_closest_stations">
<span class="sig-name descname"><span class="pre">n_closest_stations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">available_stations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BPMF.dataset.Event.n_closest_stations" title="Permalink to this definition">¶</a></dt>
<dd><p>Adjust <cite>self.stations</cite> to the <cite>n</cite> closest stations.</p>
<p>Find the <cite>n</cite> closest stations and modify <cite>self.stations</cite> accordingly.
The instance’s properties will also change accordingly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<em>scalar int</em>) – The <cite>n</cite> closest stations to fetch.</p></li>
<li><p><strong>available_stations</strong> (<em>list of strings</em><em>, </em><em>default to None</em>) – The list of stations from which we search the closest stations.
If some stations are known to lack data, the user
may choose to not include these in the closest stations.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Event.pick_PS_phases">
<span class="sig-name descname"><span class="pre">pick_PS_phases</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">duration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold_P</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold_S</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset_ot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-10.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mini_batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">126</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase_on_comp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'1':</span> <span class="pre">'S',</span> <span class="pre">'2':</span> <span class="pre">'S',</span> <span class="pre">'E':</span> <span class="pre">'S',</span> <span class="pre">'N':</span> <span class="pre">'S',</span> <span class="pre">'Z':</span> <span class="pre">'P'}</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BPMF.dataset.Event.pick_PS_phases" title="Permalink to this definition">¶</a></dt>
<dd><p>Use PhaseNet (Zhu et al., 2019) to pick P and S waves.</p>
<p>Note1: PhaseNet must be used with 3-comp data.
Note2: Extra kwargs are passed to
<cite>phasenet.wrapper.automatic_detection</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>duration</strong> (<em>scalar float</em>) – Duration, in seconds, of the time window to process to search for P
and S wave arrivals.</p></li>
<li><p><strong>tag</strong> (<em>string</em>) – Tag name of the target data. For example: ‘preprocessed_1_12’.</p></li>
<li><p><strong>threshold_P</strong> (<em>scalar float</em><em>, </em><em>default to 0.60</em>) – Threshold on PhaseNet’s probabilities to trigger the identification
of a P-wave arrival.</p></li>
<li><p><strong>threshold_S</strong> (<em>scalar float</em><em>, </em><em>default to 0.60</em>) – Threshold on PhaseNet’s probabilities to trigger the identification
of a S-wave arrival.</p></li>
<li><p><strong>mini_batch_size</strong> (<em>scalar int</em><em>, </em><em>default to 126</em>) – Number of traces processed in a single batch by PhaseNet. This
shouldn’t have to be tuned.</p></li>
<li><p><strong>phase_on_comp</strong> (<em>dictionary</em><em>, </em><em>optional</em>) – Dictionary defining which seismic phase is extracted on each
component. For example, phase_on_comp[‘N’] gives the phase that is
extracted on the north component.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Event.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(20,</span> <span class="pre">15)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gain</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Velocity</span> <span class="pre">($\\mu$m/s)'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BPMF.dataset.Event.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the waveforms of the Event instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>fig</strong> – Figure instance produced by this method.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>plt.Figure</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Event.read_from_file">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">read_from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">db_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hdf5_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BPMF.dataset.Event.read_from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize an Event instance from <cite>filename</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>string</em><em>, </em><em>default to None</em>) – Name of the hdf5 file with the event’s data. If None, then
<cite>hdf5_file</cite> should be specified.</p></li>
<li><p><strong>db_path</strong> (string, default to <cite>cfg.INPUT_PATH</cite>) – Name of the directory where <cite>filename</cite> is located.</p></li>
<li><p><strong>gid</strong> (<em>string</em><em>, </em><em>default to None</em>) – If not None, this string is the hdf5’s group name of the event.</p></li>
<li><p><strong>hdf5_file</strong> (<cite>h5py.File</cite>, default to None) – If not None, is an opened file pointing directly at the subfolder of
interest.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>event</strong> – The <cite>Event</cite> instance defined by the data in <cite>filename</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>Event</cite> instance</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Event.read_waveforms">
<span class="sig-name descname"><span class="pre">read_waveforms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">duration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase_on_comp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'1':</span> <span class="pre">'S',</span> <span class="pre">'2':</span> <span class="pre">'S',</span> <span class="pre">'E':</span> <span class="pre">'S',</span> <span class="pre">'N':</span> <span class="pre">'S',</span> <span class="pre">'Z':</span> <span class="pre">'P'}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset_phase</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'P':</span> <span class="pre">1.0,</span> <span class="pre">'S':</span> <span class="pre">4.0}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_shifted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset_ot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-10.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_reader</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">reader_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BPMF.dataset.Event.read_waveforms" title="Permalink to this definition">¶</a></dt>
<dd><p>Read waveform data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>duration</strong> (<em>scalar float</em>) – Duration, in seconds, of the extracted time windows.</p></li>
<li><p><strong>phase_on_comp</strong> (<em>dictionary</em><em>, </em><em>optional</em>) – Dictionary defining which seismic phase is extracted on each
component. For example, phase_on_comp[‘N’] gives the phase that is
extracted on the north component.</p></li>
<li><p><strong>offset_phase</strong> (<em>dictionary</em><em>, </em><em>optional</em>) – Dictionary defining when the time window starts with respect to the
pick. A positive offset means the window starts before the pick. Not
used if <cite>time_shifted</cite> is False.</p></li>
<li><p><strong>time_shifted</strong> (<em>boolean</em><em>, </em><em>default to True</em>) – If True, the moveouts are used to extract time windows from specific
seismic phases. If False, windows are simply extracted with respect to
the origin time.</p></li>
<li><p><strong>offset_ot</strong> (scalar float, default to <cite>cfg.BUFFER_EXTRACTED_EVENTS_SEC</cite>) – Only used if <cite>time_shifted</cite> is False. Time, in seconds, taken before
<cite>origin_time</cite>.</p></li>
<li><p><strong>data_reader</strong> (<em>function</em><em>, </em><em>default to None</em>) – Function that takes a path and optional key-word arguments to read
data from this path and returns an <cite>obspy.Stream</cite> instance. If None,
use <cite>self.data_reader</cite> and return None if <cite>self.data_reader=None</cite>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Event.relocate">
<span class="sig-name descname"><span class="pre">relocate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'EDT'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BPMF.dataset.Event.relocate" title="Permalink to this definition">¶</a></dt>
<dd><p>Relocate with NLLoc using <cite>self.picks</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stations</strong> (<em>list of strings</em><em>, </em><em>default to None</em>) – Names of the stations to include in the relocation process. If None,
<cite>stations</cite> is set to <cite>self.stations</cite>.</p></li>
<li><p><strong>method</strong> (<em>string</em><em>, </em><em>default to 'EDT'</em>) – Optimization algorithm used by NonLinLoc. Either ‘GAU_ANALYTIC’,
‘EDT’, ‘EDT_OT’, ‘EDT_OT_WT_ML’. See NonLinLoc’s documentation for
more information.</p></li>
<li><p><strong>verbose</strong> (<em>scalar int</em><em>, </em><em>default to 0</em>) – If more than 0, print NLLoc’s outputs to the standard output.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Event.set_aux_data">
<span class="sig-name descname"><span class="pre">set_aux_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">aux_data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BPMF.dataset.Event.set_aux_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds any extra data to the Event instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>aux_data</strong> (<em>dictionary</em>) – Dictionary with any auxiliary data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Event.set_availability">
<span class="sig-name descname"><span class="pre">set_availability</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BPMF.dataset.Event.set_availability" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the data availability.</p>
<p>A station is available if at least one station has non-zero data. The
availability is then accessed via the property <cite>self.availability</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>stations</strong> (<em>list of strings</em><em> or </em><em>numpy.ndarray</em><em>, </em><em>default to None</em>) – Names of the stations on which we check availability. If None, use
<cite>self.stations</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Event.set_component_aliases">
<span class="sig-name descname"><span class="pre">set_component_aliases</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">component_aliases</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BPMF.dataset.Event.set_component_aliases" title="Permalink to this definition">¶</a></dt>
<dd><p>Set or modify the <cite>component_aliases</cite> attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>component_aliases</strong> (<em>Dictionary</em>) – Each entry of the dictionary is a list of strings.
<cite>component_aliases[comp]</cite> is the list of all aliases used for
the same component ‘comp’. For example, <cite>component_aliases[‘N’] =
[‘N’, ‘1’]</cite> means that both the ‘N’ and ‘1’ channels will be mapped
to the Event’s ‘N’ channel.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Event.set_components">
<span class="sig-name descname"><span class="pre">set_components</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">components</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BPMF.dataset.Event.set_components" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the list of components.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>components</strong> (<em>list of strings</em>) – The names of the components on which the <cite>Template</cite> instance will
work after this call to <cite>self.set_components</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Event.set_moveouts_to_empirical_times">
<span class="sig-name descname"><span class="pre">set_moveouts_to_empirical_times</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#BPMF.dataset.Event.set_moveouts_to_empirical_times" title="Permalink to this definition">¶</a></dt>
<dd><p>Set moveouts equal to picks, if available.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Event.set_moveouts_to_theoretical_times">
<span class="sig-name descname"><span class="pre">set_moveouts_to_theoretical_times</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#BPMF.dataset.Event.set_moveouts_to_theoretical_times" title="Permalink to this definition">¶</a></dt>
<dd><p>Set moveouts equal to theoretical arrival times, if available.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Event.set_source_receiver_dist">
<span class="sig-name descname"><span class="pre">set_source_receiver_dist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">network</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BPMF.dataset.Event.set_source_receiver_dist" title="Permalink to this definition">¶</a></dt>
<dd><p>Set source-receiver distances, given <cite>network</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>network</strong> (<cite>dataset.Network</cite> instance) – The <cite>Network</cite> instance with the station coordinates to use
in the source-receiver computation.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.Event.source_receiver_dist">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">source_receiver_dist</span></span><a class="headerlink" href="#BPMF.dataset.Event.source_receiver_dist" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.Event.sr">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sr</span></span><a class="headerlink" href="#BPMF.dataset.Event.sr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Event.trim_waveforms">
<span class="sig-name descname"><span class="pre">trim_waveforms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">starttime</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">endtime</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BPMF.dataset.Event.trim_waveforms" title="Permalink to this definition">¶</a></dt>
<dd><p>Trim waveforms.</p>
<p>Start times might differ of one sample on different traces. Use this
method to make sure all traces have the same start time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>starttime</strong> (<em>string</em><em> or </em><em>datetime</em><em>, </em><em>default to None</em>) – If None, use <cite>self.date</cite> as the start time.</p></li>
<li><p><strong>endtime</strong> (<em>string</em><em> or </em><em>datetime</em><em>, </em><em>default to None</em>) – If None, use <cite>self.date</cite> + <cite>self.duration</cite> as the end time.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Event.update_picks">
<span class="sig-name descname"><span class="pre">update_picks</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#BPMF.dataset.Event.update_picks" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the picks w.r.t the current origin time.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Event.update_travel_times">
<span class="sig-name descname"><span class="pre">update_travel_times</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#BPMF.dataset.Event.update_travel_times" title="Permalink to this definition">¶</a></dt>
<dd><p>Update travel times w.r.t the current origin time.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.Event.vmax_unc">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">vmax_unc</span></span><a class="headerlink" href="#BPMF.dataset.Event.vmax_unc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Event.write">
<span class="sig-name descname"><span class="pre">write</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">db_filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">db_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_waveforms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hdf5_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BPMF.dataset.Event.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write to hdf5 file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>db_filename</strong> (<em>string</em>) – Name of the hdf5 file storing the event information.</p></li>
<li><p><strong>db_path</strong> (string, default to <cite>cfg.OUTPUT_PATH</cite>) – Name of the directory with <cite>db_filename</cite>.</p></li>
<li><p><strong>save_waveforms</strong> (<em>boolean</em><em>, </em><em>default to False</em>) – If True, save the waveforms.</p></li>
<li><p><strong>gid</strong> (<em>string</em><em>, </em><em>default to None</em>) – Name of the hdf5 group where Event will be stored. If <cite>gid=None</cite>
then Event is directly stored at the root.</p></li>
<li><p><strong>hdf5_file</strong> (<cite>h5py.File</cite>, default to None) – If not None, is an opened file pointing directly at the subfolder of
interest.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="BPMF.dataset.EventGroup">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">BPMF.dataset.</span></span><span class="sig-name descname"><span class="pre">EventGroup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">events</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">network</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BPMF.dataset.EventGroup" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#BPMF.dataset.Family" title="BPMF.dataset.Family"><code class="xref py py-class docutils literal notranslate"><span class="pre">Family</span></code></a></p>
<p>A class for a group of events.</p>
<p>Each event is represented by a <cite>dataset.Event</cite> instance.</p>
<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.EventGroup.SVDWF_stack">
<span class="sig-name descname"><span class="pre">SVDWF_stack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freqmin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freqmax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_rate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expl_var</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_singular_values</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wiener_filter_colsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BPMF.dataset.EventGroup.SVDWF_stack" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.EventGroup.n_events">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_events</span></span><a class="headerlink" href="#BPMF.dataset.EventGroup.n_events" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.EventGroup.read_waveforms">
<span class="sig-name descname"><span class="pre">read_waveforms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">duration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_shifted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BPMF.dataset.EventGroup.read_waveforms" title="Permalink to this definition">¶</a></dt>
<dd><p>Call <cite>dataset.Event.read_waveform</cite> with each event.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="BPMF.dataset.Family">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">BPMF.dataset.</span></span><span class="sig-name descname"><span class="pre">Family</span></span><a class="headerlink" href="#BPMF.dataset.Family" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>An abstract class for several subclasses.</p>
<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.Family.components">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">components</span></span><a class="headerlink" href="#BPMF.dataset.Family.components" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Family.get_moveouts_arr">
<span class="sig-name descname"><span class="pre">get_moveouts_arr</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#BPMF.dataset.Family.get_moveouts_arr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Family.get_waveforms_arr">
<span class="sig-name descname"><span class="pre">get_waveforms_arr</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#BPMF.dataset.Family.get_waveforms_arr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.Family.moveouts_arr">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">moveouts_arr</span></span><a class="headerlink" href="#BPMF.dataset.Family.moveouts_arr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Family.normalize">
<span class="sig-name descname"><span class="pre">normalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rms'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BPMF.dataset.Family.normalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Normalize the template waveforms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>method</strong> (<em>string</em><em>, </em><em>default to 'rms'</em>) – Either ‘rms’ (default) or ‘max’.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Family.read_waveforms">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">read_waveforms</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#BPMF.dataset.Family.read_waveforms" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Family.set_network">
<span class="sig-name descname"><span class="pre">set_network</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">network</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BPMF.dataset.Family.set_network" title="Permalink to this definition">¶</a></dt>
<dd><p>Update <cite>self.network</cite> to the new desired <cite>network</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>network</strong> (<cite>dataset.Network</cite> instance) – The <cite>Network</cite> instance used to query consistent data accross all
templates.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Family.set_source_receiver_dist">
<span class="sig-name descname"><span class="pre">set_source_receiver_dist</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#BPMF.dataset.Family.set_source_receiver_dist" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the source-receiver distances for template.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.Family.stations">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">stations</span></span><a class="headerlink" href="#BPMF.dataset.Family.stations" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.Family.waveforms_arr">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">waveforms_arr</span></span><a class="headerlink" href="#BPMF.dataset.Family.waveforms_arr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="BPMF.dataset.Network">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">BPMF.dataset.</span></span><span class="sig-name descname"><span class="pre">Network</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">network_file</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BPMF.dataset.Network" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Station metadata.</p>
<p>Contains station metadata.</p>
<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Network.box">
<span class="sig-name descname"><span class="pre">box</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lat_min</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon_min</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon_max</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BPMF.dataset.Network.box" title="Permalink to this definition">¶</a></dt>
<dd><p>Geographical selection of sub-network.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lat_min</strong> (<em>scalar</em><em>, </em><em>float</em>) – Minimum latitude of the box.</p></li>
<li><p><strong>lat_max</strong> (<em>scalar</em><em>, </em><em>float</em>) – Maximum latitude of the box.</p></li>
<li><p><strong>lon_min</strong> (<em>scalar</em><em>, </em><em>float</em>) – Minimum longitude of the box.</p></li>
<li><p><strong>lon_max</strong> (<em>scalar</em><em>, </em><em>float</em>) – Maximum longitude of the box.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>subnet</strong> – The Network instance restricted to the relevant stations.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Network instance</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Network.datelist">
<span class="sig-name descname"><span class="pre">datelist</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#BPMF.dataset.Network.datelist" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.Network.depth">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">depth</span></span><a class="headerlink" href="#BPMF.dataset.Network.depth" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.Network.elevation">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">elevation</span></span><a class="headerlink" href="#BPMF.dataset.Network.elevation" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.Network.interstation_distances">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">interstation_distances</span></span><a class="headerlink" href="#BPMF.dataset.Network.interstation_distances" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the distance between all station pairs.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.Network.latitude">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">latitude</span></span><a class="headerlink" href="#BPMF.dataset.Network.latitude" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.Network.longitude">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">longitude</span></span><a class="headerlink" href="#BPMF.dataset.Network.longitude" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.Network.n_components">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_components</span></span><a class="headerlink" href="#BPMF.dataset.Network.n_components" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.Network.n_stations">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_stations</span></span><a class="headerlink" href="#BPMF.dataset.Network.n_stations" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.Network.networks">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">networks</span></span><a class="headerlink" href="#BPMF.dataset.Network.networks" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Network.plot_map">
<span class="sig-name descname"><span class="pre">plot_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(20,</span> <span class="pre">10)</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BPMF.dataset.Network.plot_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot stations on map.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> (<cite>plt.Axes</cite>, default to None) – If None, create a new <cite>plt.Figure</cite> and <cite>plt.Axes</cite> instances. If
speficied by user, use the provided instance to plot.</p></li>
<li><p><strong>figsize</strong> (<em>tuple of floats</em><em>, </em><em>default to</em><em> (</em><em>20</em><em>, </em><em>10</em><em>)</em>) – Size, in inches, of the figure (width, height).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fig</strong> – The map with seismic stations.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>plt.Figure</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Network.read">
<span class="sig-name descname"><span class="pre">read</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#BPMF.dataset.Network.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads the metadata from the file at self.where</p>
<p>Note: This function can be modified to match the user’s
data convention.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.Network.station_indexes">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">station_indexes</span></span><a class="headerlink" href="#BPMF.dataset.Network.station_indexes" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.Network.stations">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">stations</span></span><a class="headerlink" href="#BPMF.dataset.Network.stations" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Network.stations_idx">
<span class="sig-name descname"><span class="pre">stations_idx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stations</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BPMF.dataset.Network.stations_idx" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Network.subset">
<span class="sig-name descname"><span class="pre">subset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stations</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">components</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'keep'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BPMF.dataset.Network.subset" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stations</strong> (<em>list</em><em> or </em><em>array of strings</em>) – Stations to keep or discard, depending on the method.</p></li>
<li><p><strong>components</strong> (<em>list</em><em> or </em><em>array of strings</em>) – Components to keep or discard, depending on the method.</p></li>
<li><p><strong>method</strong> (<em>string</em><em>, </em><em>default to 'keep'</em>) – Should be ‘keep’ or ‘discard’.
If ‘keep’, the stations and components provided to
this function are what will be left in the subnetwork.
If ‘discard’, the stations and components provided to
this function are what won’t be featured in the
subnetwork.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>subnetwork</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="BPMF.dataset.Stack">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">BPMF.dataset.</span></span><span class="sig-name descname"><span class="pre">Stack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stacked_traces</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">moveouts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stations</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phases</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latitude</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">longitude</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">component_aliases</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'E':</span> <span class="pre">['E',</span> <span class="pre">'2'],</span> <span class="pre">'N':</span> <span class="pre">['N',</span> <span class="pre">'1'],</span> <span class="pre">'Z':</span> <span class="pre">['Z']}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">components</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['N',</span> <span class="pre">'E',</span> <span class="pre">'Z']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aux_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filtered_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BPMF.dataset.Stack" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#BPMF.dataset.Event" title="BPMF.dataset.Event"><code class="xref py py-class docutils literal notranslate"><span class="pre">Event</span></code></a></p>
<p>A modification of the Event class for stacked events.</p>
<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Stack.pick_PS_phases">
<span class="sig-name descname"><span class="pre">pick_PS_phases</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">duration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold_P</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold_S</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mini_batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">126</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase_on_comp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'1':</span> <span class="pre">'S',</span> <span class="pre">'2':</span> <span class="pre">'S',</span> <span class="pre">'E':</span> <span class="pre">'S',</span> <span class="pre">'N':</span> <span class="pre">'S',</span> <span class="pre">'Z':</span> <span class="pre">'P'}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">err_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">central</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BPMF.dataset.Stack.pick_PS_phases" title="Permalink to this definition">¶</a></dt>
<dd><p>Use PhaseNet (Zhu et al., 2019) to pick P and S waves.</p>
<p>Note1: PhaseNet must be used with 3-comp data.
Note2: Extra kwargs are passed to
<cite>phasenet.wrapper.automatic_detection</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>duration</strong> (<em>scalar float</em>) – Duration, in seconds, of the time window to process to search for P
and S wave arrivals.</p></li>
<li><p><strong>threshold_P</strong> (<em>scalar float</em><em>, </em><em>default to 0.60</em>) – Threshold on PhaseNet’s probabilities to trigger the identification
of a P-wave arrival.</p></li>
<li><p><strong>threshold_S</strong> (<em>scalar float</em><em>, </em><em>default to 0.60</em>) – Threshold on PhaseNet’s probabilities to trigger the identification
of a S-wave arrival.</p></li>
<li><p><strong>mini_batch_size</strong> (<em>scalar int</em><em>, </em><em>default to 126</em>) – Number of traces processed in a single batch by PhaseNet. This
shouldn’t have to be tuned.</p></li>
<li><p><strong>phase_on_comp</strong> (<em>dictionary</em><em>, </em><em>optional</em>) – Dictionary defining which seismic phase is extracted on each
component. For example, phase_on_comp[‘N’] gives the phase that is
extracted on the north component.</p></li>
<li><p><strong>n_threshold</strong> (<em>scalar int</em><em>, </em><em>optional</em>) – Used if <cite>self.filtered_data</cite> is not None. Minimum number of
successful picks to keep the phase. Default to 1.</p></li>
<li><p><strong>err_threshold</strong> (<em>scalar int</em><em> or </em><em>float</em><em>, </em><em>optional</em>) – Used if <cite>self.filtered_data</cite> is not None. Maximum error (in samples)
on pick to keep the phase. Default to 100.</p></li>
<li><p><strong>central</strong> (<em>string</em><em>, </em><em>optional</em>) – Used if <cite>self.filtered_data</cite> is not None. Either ‘mean’ or ‘mode’.
The pick is either taken as the mean or the mode of the empirical
distribution of picks.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Stack.read_waveforms">
<span class="sig-name descname"><span class="pre">read_waveforms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">duration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase_on_comp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'1':</span> <span class="pre">'S',</span> <span class="pre">'2':</span> <span class="pre">'S',</span> <span class="pre">'E':</span> <span class="pre">'S',</span> <span class="pre">'N':</span> <span class="pre">'S',</span> <span class="pre">'Z':</span> <span class="pre">'P'}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset_phase</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'P':</span> <span class="pre">1.0,</span> <span class="pre">'S':</span> <span class="pre">4.0}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_shifted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset_ot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-10.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BPMF.dataset.Stack.read_waveforms" title="Permalink to this definition">¶</a></dt>
<dd><p>Read waveform data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>duration</strong> (<em>scalar float</em>) – Duration, in seconds, of the extracted time windows.</p></li>
<li><p><strong>phase_on_comp</strong> (<em>dictionary</em><em>, </em><em>optional</em>) – Dictionary defining which seismic phase is extracted on each
component. For example, phase_on_comp[‘N’] gives the phase that is
extracted on the north component.</p></li>
<li><p><strong>offset_phase</strong> (<em>dictionary</em><em>, </em><em>optional</em>) – Dictionary defining when the time window starts with respect to the
pick. A positive offset means the window starts before the pick. Not
used if <cite>time_shifted</cite> is False.</p></li>
<li><p><strong>time_shifted</strong> (<em>boolean</em><em>, </em><em>default to True</em>) – If True, the moveouts are used to extract time windows from specific
seismic phases. If False, windows are simply extracted with respect to
the origin time.</p></li>
<li><p><strong>offset_ot</strong> (scalar float, default to <cite>cfg.BUFFER_EXTRACTED_EVENTS_SEC</cite>) – Only used if <cite>time_shifted</cite> is False. Time, in seconds, taken before
<cite>origin_time</cite>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="BPMF.dataset.Template">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">BPMF.dataset.</span></span><span class="sig-name descname"><span class="pre">Template</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">origin_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">moveouts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stations</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phases</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">template_filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">template_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latitude</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">longitude</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">components</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['N',</span> <span class="pre">'E',</span> <span class="pre">'Z']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BPMF.dataset.Template" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#BPMF.dataset.Event" title="BPMF.dataset.Event"><code class="xref py py-class docutils literal notranslate"><span class="pre">Event</span></code></a></p>
<p>A class for template events.</p>
<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Template.distance">
<span class="sig-name descname"><span class="pre">distance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">longitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BPMF.dataset.Template.distance" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute distance between template and a given location.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>longitude</strong> (<em>scalar</em><em>, </em><em>float</em>) – Longitude of the target location.</p></li>
<li><p><strong>latitude</strong> (<em>scalar</em><em>, </em><em>float</em>) – Latitude of the target location.</p></li>
<li><p><strong>depth</strong> (<em>scalar</em><em>, </em><em>float</em>) – Depth of the target location, in km.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Template.init_from_event">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">init_from_event</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">event</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attach_waveforms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BPMF.dataset.Template.init_from_event" title="Permalink to this definition">¶</a></dt>
<dd><p>Instanciate a <cite>Template</cite> object from an <cite>Event</cite> object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>event</strong> (<cite>Event</cite> instance) – The <cite>Event</cite> instance to convert to a <cite>Template</cite> instance.</p></li>
<li><p><strong>attach_waveforms</strong> (<em>boolean</em><em>, </em><em>default to True</em>) – Should not be turned to False when used directly.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>template</strong> – <cite>Template</cite> instance base on <cite>event</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Template instance</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.Template.moveouts_arr">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">moveouts_arr</span></span><a class="headerlink" href="#BPMF.dataset.Template.moveouts_arr" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a moveout array given self.components and phase_on_comp.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.Template.moveouts_win">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">moveouts_win</span></span><a class="headerlink" href="#BPMF.dataset.Template.moveouts_win" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Template.n_best_SNR_stations">
<span class="sig-name descname"><span class="pre">n_best_SNR_stations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">available_stations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BPMF.dataset.Template.n_best_SNR_stations" title="Permalink to this definition">¶</a></dt>
<dd><p>Adjust <cite>self.stations</cite> to the <cite>n</cite> best SNR stations.</p>
<p>Find the <cite>n</cite> best stations and modify <cite>self.stations</cite> accordingly.
The instance’s properties will also change accordingly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<em>scalar int</em>) – The <cite>n</cite> closest stations.</p></li>
<li><p><strong>available_stations</strong> (<em>list of strings</em><em>, </em><em>default to None</em>) – The list of stations from which we search the closest stations.
If some stations are known to lack data, the user
may choose to not include these in the closest stations.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Template.plot_detection">
<span class="sig-name descname"><span class="pre">plot_detection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">db_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">duration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">60.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase_on_comp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'1':</span> <span class="pre">'S',</span> <span class="pre">'2':</span> <span class="pre">'S',</span> <span class="pre">'E':</span> <span class="pre">'S',</span> <span class="pre">'N':</span> <span class="pre">'S',</span> <span class="pre">'Z':</span> <span class="pre">'P'}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset_ot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10.0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BPMF.dataset.Template.plot_detection" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the <cite>idx</cite>-th detection made with this template.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>string</em><em>, </em><em>default to None</em>) – Name of the detection file. If None, use the standard file
and folder naming convention.</p></li>
<li><p><strong>db_path</strong> (<em>string</em><em>, </em><em>default to None</em>) – Name of the directory where the detection file is located. If None,
use the standard file and folder naming convention.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Template.plot_recurrence_times">
<span class="sig-name descname"><span class="pre">plot_recurrence_times</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">annotate_axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(20,</span> <span class="pre">10)</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BPMF.dataset.Template.plot_recurrence_times" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot recurrence times vs detection times.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ax</strong> (<cite>plt.Axes</cite>, default to None) – If not None, use this <cite>plt.Axes</cite> instance to plot the data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Template.read_catalog">
<span class="sig-name descname"><span class="pre">read_catalog</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">db_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_attributes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">nan</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_events</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_summary_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BPMF.dataset.Template.read_catalog" title="Permalink to this definition">¶</a></dt>
<dd><p>Build a <cite>Catalog</cite> instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>string</em><em>, </em><em>default to None</em>) – Name of the detection file. If None, use the standard file
and folder naming convention.</p></li>
<li><p><strong>db_path</strong> (<em>string</em><em>, </em><em>default to None</em>) – Name of the directory where the detection file is located. If None,
use the standard file and folder naming convention.</p></li>
<li><p><strong>gid</strong> (<em>string</em><em>, </em><em>int</em><em>, or </em><em>float</em><em>, </em><em>default to None</em>) – If not None, this is the hdf5 group where to read the data.</p></li>
<li><p><strong>extra_attributes</strong> (<em>list of strings</em><em>, </em><em>default to</em><em> [</em><em>]</em>) – Attributes to read in addition to the default ‘longitude’,
‘latitude’, ‘depth’, and ‘origin_time’.</p></li>
<li><p><strong>fill_value</strong> (<em>string</em><em>, </em><em>int</em><em>, or </em><em>float</em><em>, </em><em>default to np.nan</em>) – Default value if the target attribute does not exist.</p></li>
<li><p><strong>return_events</strong> (<em>boolean</em><em>, </em><em>default to False</em>) – If True, return a list of <cite>dataset.Event</cite> instances. Can only be
True if <cite>check_summary_file=False</cite>.</p></li>
<li><p><strong>check_summary_file</strong> (<em>boolean</em><em>, </em><em>default to True</em>) – If True, check if the summary hdf5 file already exists and read from
if it does; this uses the standard naming convention. If False,
it builds the catalog from the detection output.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Template.read_from_file">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">read_from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">db_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BPMF.dataset.Template.read_from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize a <cite>Template</cite> instance from a file.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Template.read_waveforms">
<span class="sig-name descname"><span class="pre">read_waveforms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">components</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BPMF.dataset.Template.read_waveforms" title="Permalink to this definition">¶</a></dt>
<dd><p>Read the waveforms time series.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.Template.template_idx">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">template_idx</span></span><a class="headerlink" href="#BPMF.dataset.Template.template_idx" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.Template.tid">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">tid</span></span><a class="headerlink" href="#BPMF.dataset.Template.tid" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.Template.waveforms_arr">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">waveforms_arr</span></span><a class="headerlink" href="#BPMF.dataset.Template.waveforms_arr" title="Permalink to this definition">¶</a></dt>
<dd><p>Return traces in numpy.ndarray.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Template.write">
<span class="sig-name descname"><span class="pre">write</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">db_filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">db_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_waveforms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BPMF.dataset.Template.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write to hdf5 file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>db_filename</strong> (<em>string</em>) – Name of the hdf5 file storing the event information.</p></li>
<li><p><strong>db_path</strong> (string, default to <cite>cfg.OUTPUT_PATH</cite>) – Name of the directory with <cite>db_filename</cite>.</p></li>
<li><p><strong>save_waveforms</strong> (<em>boolean</em><em>, </em><em>default to False</em>) – If True, save the waveforms.</p></li>
<li><p><strong>gid</strong> (<em>string</em><em>, </em><em>default to None</em>) – Name of the hdf5 group where Event will be stored. If <cite>gid=None</cite>
then Event is directly stored at the root.</p></li>
<li><p><strong>hdf5_file</strong> (<cite>h5py.File</cite>, default to None) – If not None, is an opened file pointing directly at the subfolder of
interest.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.Template.write_summary">
<span class="sig-name descname"><span class="pre">write_summary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">attributes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">db_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BPMF.dataset.Template.write_summary" title="Permalink to this definition">¶</a></dt>
<dd><p>Write summary of template characteristics.</p>
<p>hdf5 does not support storing datasets of strings. Therefore, You need
to convert strings to bytes or this method will raise an error.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>attributes</strong> (<em>dictionary</em>) – Dictionary with scalars, <cite>numpy.ndarray</cite>, dictionary, or
<cite>pandas.DataFrame</cite>. The keys of the dictionary are used to name the
dataset or group in the hdf5 file.</p></li>
<li><p><strong>filename</strong> (<em>string</em><em>, </em><em>default to None</em>) – Name of the detection file. If None, use the standard file
and folder naming convention.</p></li>
<li><p><strong>db_path</strong> (<em>string</em><em>, </em><em>default to None</em>) – Name of the directory where the detection file is located. If None,
use the standard file and folder naming convention.</p></li>
<li><p><strong>overwrite</strong> (<em>boolean</em><em>, </em><em>default to True</em>) – If True, overwrite existing datasets or groups.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="BPMF.dataset.TemplateGroup">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">BPMF.dataset.</span></span><span class="sig-name descname"><span class="pre">TemplateGroup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">templates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">network</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_receiver_dist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BPMF.dataset.TemplateGroup" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#BPMF.dataset.Family" title="BPMF.dataset.Family"><code class="xref py py-class docutils literal notranslate"><span class="pre">Family</span></code></a></p>
<p>A class for a group of templates.</p>
<p>Each template is represented by a <cite>dataset.Template</cite> instance.</p>
<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.TemplateGroup.box">
<span class="sig-name descname"><span class="pre">box</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lon_min</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat_min</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BPMF.dataset.TemplateGroup.box" title="Permalink to this definition">¶</a></dt>
<dd><p>Keep templates inside the requested geographic bounds.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lon_min</strong> (<em>scalar float</em>) – Minimum longitude, in decimal degrees.</p></li>
<li><p><strong>lon_max</strong> (<em>scalar float</em>) – Maximum longitude, in decimal degrees.</p></li>
<li><p><strong>lat_min</strong> (<em>scalar float</em>) – Minimum latitude, in decimal degrees.</p></li>
<li><p><strong>lat_max</strong> (<em>scalar float</em>) – Maximum latitude, in decimal degrees.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.TemplateGroup.compute_dir_errors">
<span class="sig-name descname"><span class="pre">compute_dir_errors</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#BPMF.dataset.TemplateGroup.compute_dir_errors" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute length of uncertainty ellipsoid in inter-template direction.</p>
<dl class="simple">
<dt>_dir_errors: (n_templates, n_templates) pandas.DataFrame</dt><dd><p>The length, in kilometers, of the uncertainty ellipsoid in the
inter-template direction.
Example: self.directional_errors.loc[tid1, tid2] is the width of
template tid1’s uncertainty ellipsoid in the direction of
template tid2.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.TemplateGroup.compute_ellipsoid_dist">
<span class="sig-name descname"><span class="pre">compute_ellipsoid_dist</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#BPMF.dataset.TemplateGroup.compute_ellipsoid_dist" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute separation between unc. ellipsoids in inter-template dir.</p>
<p>Can be negative if the uncertainty ellipsoids overlap.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.TemplateGroup.compute_intertemplate_cc">
<span class="sig-name descname"><span class="pre">compute_intertemplate_cc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">distance_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_stations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_lag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_cc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_from_scratch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cpu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BPMF.dataset.TemplateGroup.compute_intertemplate_cc" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the pairwise template CCs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>distance_threshold</strong> (<em>float</em><em>, </em><em>default to 5</em>) – The distance threshold, in kilometers, between two
uncertainty ellipsoids under which similarity is computed.</p></li>
<li><p><strong>n_stations</strong> (<em>integer</em><em>, </em><em>default to 10</em>) – The number of stations closest to each template used in
the computation of the average CC.</p></li>
<li><p><strong>max_lag</strong> (<em>integer</em><em>, </em><em>default to 10</em>) – Maximum lag, in samples, allowed when searching for the
maximum CC on each channel. This is to account for small
discrepancies in windowing that could occur for two templates
highly similar but associated to slightly different locations.</p></li>
<li><p><strong>save_cc</strong> (<em>boolean</em><em>, </em><em>default to False</em>) – If True, save the inter-template CCs in the same folder as
<cite>self.templates[0]</cite> and with filename ‘intertp_cc.h5’.</p></li>
<li><p><strong>compute_from_scratch</strong> (<em>boolean</em><em>, </em><em>default to False</em>) – If True, force to compute the inter-template CCs from scratch.
Useful if user knows the computation is faster than reading a
potentially large file.</p></li>
<li><p><strong>device</strong> (<em>string</em><em>, </em><em>default to 'cpu'</em>) – Either ‘cpu’ or ‘gpu’.</p></li>
<li><p><strong>progress</strong> (<em>boolean</em><em>, </em><em>default to False</em>) – If True, print progress bar with <cite>tqdm</cite>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.TemplateGroup.compute_intertemplate_dist">
<span class="sig-name descname"><span class="pre">compute_intertemplate_dist</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#BPMF.dataset.TemplateGroup.compute_intertemplate_dist" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the template-pairwise distances, in km.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.TemplateGroup.dir_errors">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dir_errors</span></span><a class="headerlink" href="#BPMF.dataset.TemplateGroup.dir_errors" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.TemplateGroup.ellipsoid_dist">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ellipsoid_dist</span></span><a class="headerlink" href="#BPMF.dataset.TemplateGroup.ellipsoid_dist" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.TemplateGroup.intertemplate_cc">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">intertemplate_cc</span></span><a class="headerlink" href="#BPMF.dataset.TemplateGroup.intertemplate_cc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.TemplateGroup.intertemplate_dist">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">intertemplate_dist</span></span><a class="headerlink" href="#BPMF.dataset.TemplateGroup.intertemplate_dist" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.TemplateGroup.n_best_SNR_stations">
<span class="sig-name descname"><span class="pre">n_best_SNR_stations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">available_stations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BPMF.dataset.TemplateGroup.n_best_SNR_stations" title="Permalink to this definition">¶</a></dt>
<dd><p>Adjust <cite>self.stations</cite> on each template to the <cite>n</cite> best SNR stations.</p>
<p>Find the <cite>n</cite> best stations and modify <cite>self.stations</cite> accordingly.
The instance’s properties will also change accordingly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<em>scalar int</em>) – The <cite>n</cite> closest stations.</p></li>
<li><p><strong>available_stations</strong> (<em>list of strings</em><em>, </em><em>default to None</em>) – The list of stations from which we search the closest stations.
If some stations are known to lack data, the user
may choose to not include these in the closest stations.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.TemplateGroup.n_closest_stations">
<span class="sig-name descname"><span class="pre">n_closest_stations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">available_stations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BPMF.dataset.TemplateGroup.n_closest_stations" title="Permalink to this definition">¶</a></dt>
<dd><p>Adjust <cite>self.stations</cite> on each template to the <cite>n</cite> closest stations.</p>
<p>Find the <cite>n</cite> closest stations and modify <cite>self.stations</cite> accordingly.
The instance’s properties will also change accordingly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<em>scalar int</em>) – The <cite>n</cite> closest stations to fetch.</p></li>
<li><p><strong>available_stations</strong> (<em>list of strings</em><em>, </em><em>default to None</em>) – The list of stations from which we search the closest stations.
If some stations are known to lack data, the user
may choose to not include these in the closest stations.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.TemplateGroup.n_templates">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_templates</span></span><a class="headerlink" href="#BPMF.dataset.TemplateGroup.n_templates" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="BPMF.dataset.TemplateGroup.network_to_template_map">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">network_to_template_map</span></span><a class="headerlink" href="#BPMF.dataset.TemplateGroup.network_to_template_map" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.TemplateGroup.plot_detection">
<span class="sig-name descname"><span class="pre">plot_detection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BPMF.dataset.TemplateGroup.plot_detection" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>idx</strong> (<em>scalar int</em>) – Event index in <cite>self.catalog.catalog</cite>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fig</strong> – The figure showing the detected event.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>plt.Figure</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.TemplateGroup.plot_recurrence_times">
<span class="sig-name descname"><span class="pre">plot_recurrence_times</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(20,</span> <span class="pre">10)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BPMF.dataset.TemplateGroup.plot_recurrence_times" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot recurrence times vs detection times, template-wise.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>figsize</strong> (<em>tuple of floats</em><em>, </em><em>default to</em><em> (</em><em>20</em><em>, </em><em>10</em><em>)</em>) – Size in inches of the figure (width, height).</p></li>
<li><p><strong>progress</strong> (<em>boolean</em><em>, </em><em>default to False</em>) – If True, print progress bar with <cite>tqdm</cite>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.TemplateGroup.read_catalog">
<span class="sig-name descname"><span class="pre">read_catalog</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">extra_attributes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">nan</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BPMF.dataset.TemplateGroup.read_catalog" title="Permalink to this definition">¶</a></dt>
<dd><p>Build a catalog from all templates’ detections.</p>
<p>Work only if folder and file names follow the standard convention.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>extra_attributes</strong> (<em>list of strings</em><em>, </em><em>default to</em><em> [</em><em>]</em>) – Attributes to read in addition to the default ‘longitude’,
‘latitude’, ‘depth’, and ‘origin_time’.</p></li>
<li><p><strong>fill_value</strong> (<em>string</em><em>, </em><em>int</em><em>, or </em><em>float</em><em>, </em><em>default to np.nan</em>) – Default value if the target attribute does not exist.</p></li>
<li><p><strong>progress</strong> (<em>boolean</em><em>, </em><em>default to False</em>) – If True, print progress bar with <cite>tqdm</cite>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.TemplateGroup.read_from_files">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">read_from_files</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filenames</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">network</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BPMF.dataset.TemplateGroup.read_from_files" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the TemplateGroup instance given a list of filenames.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filenames</strong> (<em>(</em><em>n_templates</em><em>,</em><em>) </em><em>list of strings</em>) – List of full file paths from which we instanciate the list of
<cite>dataset.Template</cite> objects.</p></li>
<li><p><strong>network</strong> (<cite>dataset.Network</cite> instance) – The <cite>Network</cite> instance used to query consistent data accross all
templates.</p></li>
<li><p><strong>gids</strong> (<em>(</em><em>n_templates</em><em>,</em><em>) </em><em>list of strings</em><em>, </em><em>default to None</em>) – If not None, this should be a list of group ids where the template
data are stored in their hdf5 files.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>template_group</strong> – The initialized TemplateGroup instance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>TemplateGroup instance</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.TemplateGroup.read_waveforms">
<span class="sig-name descname"><span class="pre">read_waveforms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BPMF.dataset.TemplateGroup.read_waveforms" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>progress</strong> (<em>boolean</em><em>, </em><em>default to False</em>) – If True, print progress bar with <cite>tqdm</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.TemplateGroup.remove_multiples">
<span class="sig-name descname"><span class="pre">remove_multiples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_closest_stations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt_criterion</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distance_criterion</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">speed_criterion</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">similarity_criterion</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BPMF.dataset.TemplateGroup.remove_multiples" title="Permalink to this definition">¶</a></dt>
<dd><p>Search for events detected by multiple templates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_closest_stations</strong> (<em>integer</em><em>, </em><em>default to 10</em>) – In case template similarity is taken into account,
this is the number of stations closest to each template
that are used in the calculation of the average cc.</p></li>
<li><p><strong>dt_criterion</strong> (<em>float</em><em>, </em><em>default to 4</em>) – Time interval, in seconds, under which two events are
examined for redundancy.</p></li>
<li><p><strong>distance_criterion</strong> (<em>float</em><em>, </em><em>default to 1</em>) – Distance threshold, in kilometers, between two uncertainty
ellipsoids under which two events are examined for redundancy.</p></li>
<li><p><strong>speed_criterion</strong> (<em>float</em><em>, </em><em>default to 5</em>) – Speed criterion, in km/s, below which the inter-event time and
inter-event distance can be explained by errors in origin times and
a reasonable P-wave speed.</p></li>
<li><p><strong>similarity_criterion</strong> (<em>float</em><em>, </em><em>default to -1</em>) – Template similarity threshold, in terms of average CC, over
which two events are examined for redundancy. The default
value of -1 is always verified, meaning that similarity is
actually not taken into account.</p></li>
<li><p><strong>progress</strong> (<em>boolean</em><em>, </em><em>default to False</em>) – If True, print progress bar with <cite>tqdm</cite>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BPMF.dataset.TemplateGroup.set_network_to_template_map">
<span class="sig-name descname"><span class="pre">set_network_to_template_map</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#BPMF.dataset.TemplateGroup.set_network_to_template_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the map between network arrays and template data.</p>
<p>Template data are broadcasted to fit the dimensions of the network
arrays. This method computes the <cite>network_to_template_map</cite> that tells
which stations and channels are used on each template. For example:
<cite>network_to_template_map[t, s, c] = False</cite> means that station s and
channel c are not used on template t.</p>
</dd></dl>

</dd></dl>

</section>

            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">

          <div class="sidebar-resize-handle"></div>

<h3><a href="../../index.html">Table of Contents</a></h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../introduction.html">Introduction</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../usage.html">Usage</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../api.html">API</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../updates.html">Updates</a></li>
</ul>

<hr class="docutils" />
<ul>
  <li class="toctree-l1"><a class="reference internal" href="../../genindex.html" accesskey="I">General Index</a></li>
  <li class="toctree-l1"><a class="reference internal" href="../../py-modindex.html">Python Module Index</a></li>
</ul>
<div id="ethical-ad-placement"></div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>

    <nav class="relbar">
      <a class="previous" href="../api.html" aria-label="Previous topic" >
        <div class="icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M257.5 445.1l-22.2 22.2c-9.4 9.4-24.6 9.4-33.9 0L7 273c-9.4-9.4-9.4-24.6 0-33.9L201.4 44.7c9.4-9.4 24.6-9.4 33.9 0l22.2 22.2c9.5 9.5 9.3 25-.4 34.3L136.6 216H424c13.3 0 24 10.7 24 24v32c0 13.3-10.7 24-24 24H136.6l120.5 114.8c9.8 9.3 10 24.8.4 34.3z"/></svg>
        </div>
        <div class="title">
          <span class="text">
            <span class="direction">previous</span>
            API
          </span>
        </div>
      </a>
      <a class="next" href="template_search.html" aria-label="Next topic" >
        <div class="title">
          <span class="text">
            <span class="direction">next</span>
            BPMF.template_search
          </span>
        </div>
        <div class="icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M190.5 66.9l22.2-22.2c9.4-9.4 24.6-9.4 33.9 0L441 239c9.4 9.4 9.4 24.6 0 33.9L246.6 467.3c-9.4 9.4-24.6 9.4-33.9 0l-22.2-22.2c-9.5-9.5-9.3-25 .4-34.3L311.4 296H24c-13.3 0-24-10.7-24-24v-32c0-13.3 10.7-24 24-24h287.4L190.9 101.2c-9.8-9.3-10-24.8-.4-34.3z"/></svg>
        </div>
      </a>
    </nav>

    <footer role="contentinfo">
      &#169; Copyright 2022, Eric Beauce, William B. Frank.
      Created using <a class="reference external" href="https://www.sphinx-doc.org/">Sphinx</a> 5.1.1.
      <a class="reference external" href="https://insipid-sphinx-theme.readthedocs.io/">Insipid Theme</a>.
<a class="reference internal" href="../../_sources/usage/api/dataset.rst.txt" rel="nofollow">Show Source</a>.
    </footer>
  </body>
</html>